[{"title":"Parallax Background and Level Bounds - Platformer Tutorial Part 6 - Godot","url":"http://damarindra.com/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/","content":"<div class=\"spoiler collapsed\"><div class=\"spoiler-title\">Table of Content</div><div class=\"spoiler-content\"><!-- toc --></div></div>\n<p>This is the sixth part of the tutorial creating platformer game on Godot Engine. In this tutorial I will explain using parallax background node and make level bounds.<br><a id=\"more\"></a></p>\n<ol>\n<li><a href=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/\" title=\"Part 1 : Preparation\">Part 1 : Preparation</a></li>\n<li><a href=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/\" title=\"Part 2 : Player Creation\">Part 2 : Player Creation</a></li>\n<li><a href=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/\" title=\"Part 3 : Player Creation 2\">Part 3 : Player Creation 2</a></li>\n<li><a href=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/\" title=\"Part 4 : Tilemap and Camera\">Part 4 : Tilemap and Camera</a></li>\n<li><a href=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/\" title=\"Part 5 : Player Animation\">Part 5 : Player Animation</a></li>\n<li><strong>Part 6 : Parallax Background and Level Bounds</strong></li>\n</ol>\n<h2 id=\"Parallax-Background\"><a href=\"#Parallax-Background\" class=\"headerlink\" title=\"Parallax Background\"></a>Parallax Background</h2><p>Godot provides <strong>Parallax Background</strong> node, we don’t need to code our background because what we need is already in <strong>Parallax Background</strong> node. Create a new <strong>Parallax Background</strong> node inside our root node. Inside <strong>ParallaxBackground</strong> node, create a new <strong>ParallaxLayer</strong> node and inside <strong>ParallaxLayer</strong> node, create a new <strong>Sprite</strong> node. So this is how it looks like.</p>\n<img src=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/parallax_bg_node.jpg\" alt=\"Parallax Background Node\" title=\"Parallax Background Node\">\n<div class=\"alert info\"><p><strong>ParallaxBackground</strong> : Container node for parallax layer, all ParallaxLayer must be inside ParallaxBackground. ParallaxBackground also has inspector option, you can learn more by visiting Godot documentation.</p>\n<p><strong>ParallaxLayer</strong> : Container for parallax sprite. Drop all sprite into this layer and will be automatically moving depending on camera movement. ParallaxLayer has inspector option for motion. <strong>scale</strong> for movement speed, 1 makes sprite not moving (only repeating), 0 makes sprite always follow camera movement. <strong>offset</strong> as it says, for offset. <strong>mirroring</strong> makes sprite will repeating after a certain point.</p>\n</div>\n<h3 id=\"Setup-Sprite\"><a href=\"#Setup-Sprite\" class=\"headerlink\" title=\"Setup Sprite\"></a>Setup Sprite</h3><p>This time, our sprite configuration is a little bit different. Load our texture as we used to be. After that, disable the <strong>Centered</strong> option, this makes our sprite start from <em>top left</em>, this is <strong>IMPORTANT</strong> for making parallax. Next activate the <strong>Region</strong> and set the <strong>Region Rect</strong> into (0, 176, 160, 128). As you can see, we using <strong>Region Rect</strong> instead of <strong>VFrames</strong> and <strong>HFrames</strong>. <strong>Region Rect</strong> cut our sprite directly from a specific point.</p>\n<img src=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/setup_sprite.jpg\" alt=\"Sprite\" title=\"Sprite\">\n<h3 id=\"Setup-Parallax-Layer\"><a href=\"#Setup-Parallax-Layer\" class=\"headerlink\" title=\"Setup Parallax Layer\"></a>Setup Parallax Layer</h3><p>Select the <strong>ParallaxLayer</strong> node and setup the Motion. Set the <strong>Scale</strong> value to (0.5, 0.2), you can play this value. Set the <strong>Mirroring</strong> to (160,0).</p>\n<img src=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/parallax_layer.jpg\" alt=\"Parallax Layer Inspector\" title=\"Parallax Layer Inspector\">\n<p>Our Parallax Background ready! Just give it a try..</p>\n<img src=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/parallax.gif\" alt=\"Parallax Gif\" title=\"Parallax Gif\">\n<h2 id=\"Level-Bounds\"><a href=\"#Level-Bounds\" class=\"headerlink\" title=\"Level Bounds\"></a>Level Bounds</h2><p>Level bounds have 4 points, left, top, right, bottom. The function is creating bounds for the level. The camera will only render inside the bounds. Also, player can’t move outside of the level bounds.</p>\n<h3 id=\"Restrict-Camera-Render-Only-Inside-Level-Bounds\"><a href=\"#Restrict-Camera-Render-Only-Inside-Level-Bounds\" class=\"headerlink\" title=\"Restrict Camera Render Only Inside Level Bounds\"></a>Restrict Camera Render Only Inside Level Bounds</h3><p>Create <strong>Node2D</strong> inside the root node, rename it as “Bounds”. Change the <strong>Bounds</strong> scale according to how large our level world.</p>\n<img src=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/level_bounds.jpg\" alt=\"Level Bounds\" title=\"Level Bounds\">\n<p>Create a script <strong>level_bounds.gd</strong> and attach it into <strong>Bounds</strong>. Then write the code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends Node2D</div><div class=\"line\"></div><div class=\"line\">func get_left():</div><div class=\"line\">\t<span class=\"keyword\">return</span> get_pos().x - get_scale().x * <span class=\"number\">32</span></div><div class=\"line\"></div><div class=\"line\">func get_right():</div><div class=\"line\">\t<span class=\"keyword\">return</span> get_pos().x + get_scale().x * <span class=\"number\">32</span></div><div class=\"line\"></div><div class=\"line\">func get_top():</div><div class=\"line\">\t<span class=\"keyword\">return</span> get_pos().y - get_scale().y * <span class=\"number\">32</span></div><div class=\"line\"></div><div class=\"line\">func get_bottom():</div><div class=\"line\">\t<span class=\"keyword\">return</span> get_pos().y + get_scale().y * <span class=\"number\">32</span></div></pre></td></tr></table></figure>\n<div class=\"alert info\"><p>Node2D forming rectangle according to the scale. (1,1) of scale means (64,64) pixels.</p>\n</div>\n<p>The script only contains method to get each edge position. Next, open <strong>camera.gd</strong> and add this code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\"></div><div class=\"line\">func _ready():</div><div class=\"line\">\tOS.set_window_size(OS.get_window_size() * <span class=\"number\">4</span>)</div><div class=\"line\">\tset_limit(<span class=\"number\">0</span>, bounds.get_left())</div><div class=\"line\">\tset_limit(<span class=\"number\">1</span>, bounds.get_top())</div><div class=\"line\">\tset_limit(<span class=\"number\">2</span>, bounds.get_right())</div><div class=\"line\">\tset_limit(<span class=\"number\">3</span>, bounds.get_bottom())</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">#other code</span></div></pre></td></tr></table></figure>\n<p>The script will restrict the camera movement to only render inside the level bounds. So make sure your level bounds is bigger than camera render area.</p>\n<img src=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/camera_restrict.gif\" alt=\"Camera Restricted\" title=\"Camera Restricted\">\n<h3 id=\"Restrict-Player-Movement\"><a href=\"#Restrict-Player-Movement\" class=\"headerlink\" title=\"Restrict Player Movement\"></a>Restrict Player Movement</h3><p>Now, restrict the player movement, but we only using left, right, and top. Basically, when player falling down will die right? so we don’t need to restrict the bottom side. Open the <strong>level_bounds.gd</strong> and add this variable</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends Node2D</div><div class=\"line\"></div><div class=\"line\">export var left_stop = true</div><div class=\"line\">export var right_stop = true</div><div class=\"line\">export var top_stop = true</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#other code</span></div></pre></td></tr></table></figure>\n<p><strong>True</strong> means stopping the player movement, and <strong>false</strong> means let the player passing. Next, modify our <strong>player.gd</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\">#other code</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> get_center_pos().x - get_node(<span class=\"string\">\"CollisionShape2D\"</span>).get_shape().get_extents().x + velocity.x &lt; bounds.get_left() <span class=\"keyword\">and</span> bounds.left_stop:</div><div class=\"line\">\t\tvelocity.x = bounds.get_left()-get_center_pos().x + get_node(<span class=\"string\">\"CollisionShape2D\"</span>).get_shape().get_extents().x</div><div class=\"line\">\t<span class=\"keyword\">elif</span> get_center_pos().x + get_node(<span class=\"string\">\"CollisionShape2D\"</span>).get_shape().get_extents().x + velocity.x &gt; bounds.get_right() <span class=\"keyword\">and</span> bounds.right_stop:</div><div class=\"line\">\t\tvelocity.x = bounds.get_right()-get_center_pos().x - get_node(<span class=\"string\">\"CollisionShape2D\"</span>).get_shape().get_extents().x</div><div class=\"line\">\t<span class=\"keyword\">if</span> get_center_pos().y - get_node(<span class=\"string\">\"CollisionShape2D\"</span>).get_shape().get_extents().y + velocity.y &lt; bounds.get_top() <span class=\"keyword\">and</span> bounds.top_stop:</div><div class=\"line\">\t\tvelocity.y = bounds.get_top() - get_center_pos().y+ get_node(<span class=\"string\">\"CollisionShape2D\"</span>).get_shape().get_extents().x</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\"># apply the movement by calling move(velocity) and store the remaining movement</span></div><div class=\"line\">\tvar remaining_movement = move(velocity)</div><div class=\"line\">\t<span class=\"comment\">#other code</span></div></pre></td></tr></table></figure>\n<p>The result will be like this</p>\n<img src=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/player_restrict.gif\" alt=\"Player Restricted\" title=\"Player Restricted\">\n<p>Next tutorial will be about enemy, so there will be explanation about taking damage, giving damage and other things!!</p>\n<p><a href=\"https://github.com/damarindra/2D-Platformer-Godot\" target=\"_blank\" rel=\"external\">Download Project Here</a></p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>","categories":["godot","tutorial","tutorial_platformer"],"tags":["Godot","gamedev","game","development","platformer"]},{"title":"Player Animation - Platformer Tutorial Part 5 - Godot","url":"http://damarindra.com/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/","content":"<div class=\"spoiler collapsed\"><div class=\"spoiler-title\">Table of Content</div><div class=\"spoiler-content\"><!-- toc --></div></div>\n<p>This is the fifth part of the tutorial creating platformer game on Godot Engine. In this tutorial I will explain more about character setup, such animation and flipping.<br><a id=\"more\"></a></p>\n<ol>\n<li><a href=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/\" title=\"Part 1 : Preparation\">Part 1 : Preparation</a></li>\n<li><a href=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/\" title=\"Part 2 : Player Creation\">Part 2 : Player Creation</a></li>\n<li><a href=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/\" title=\"Part 3 : Player Creation 2\">Part 3 : Player Creation 2</a></li>\n<li><a href=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/\" title=\"Part 4 : Tilemap and Camera\">Part 4 : Tilemap and Camera</a></li>\n<li><strong>Part 5 : Player Animation</strong></li>\n<li><a href=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/\" title=\"Part 6 : Parallax Background and Level Bounds\">Part 6 : Parallax Background and Level Bounds</a>\n</li>\n</ol>\n<h2 id=\"Player-Direction\"><a href=\"#Player-Direction\" class=\"headerlink\" title=\"Player Direction\"></a>Player Direction</h2><p>Before we implement the animation, it will be good if the sprite direction following the character direction. If the character goes to the left direction, the character should be facing the left direction and otherwise. In the previous part, we have created <strong>facing_dir</strong>, now it’s the time to use it for fixing the sprite direction. Add one new variable <code>onready var sprite = get_node(&quot;Sprite&quot;)</code> and add one line code at the end of <code>_fixed_process</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\">#other code</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\tfacing_dir = sign(velocity.x)</div><div class=\"line\">\t<span class=\"comment\">#flip the character</span></div><div class=\"line\">\tsprite.set_flip_h(facing_dir != <span class=\"number\">1</span>)</div></pre></td></tr></table></figure>\n<p>Try it, and see what happens. When <strong>facing_dir</strong> is not equal than 1, the sprite will be flipping, and otherwise.</p>\n<img src=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/flip.gif\" alt=\"Flipping The Character\" title=\"Flipping The Character\">\n<h2 id=\"Animation\"><a href=\"#Animation\" class=\"headerlink\" title=\"Animation\"></a>Animation</h2><p>Animation in Godot can be controlled by <strong>Animation Player</strong> or <strong>Animation Tree Player</strong> node. What we will use is the <strong>Animation Player</strong> node, add this node to our player. Open <strong>player.tscn</strong> and add <strong>Animation Player</strong> as a child of <strong>Player</strong> (KinematicBody2D). Then rename it as <strong>“anim”</strong>.</p>\n<img src=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/anim_node.jpg\" alt=\"Character Node Structure\" title=\"Character Node Structure\">\n<h3 id=\"Idle\"><a href=\"#Idle\" class=\"headerlink\" title=\"Idle\"></a>Idle</h3><p>Now, we are ready to animate the sprite. Select the <strong>anim</strong> node, <strong>Animation</strong> window will appear automatically at the bottom. Click new button for creating a new animation clip.</p>\n<img src=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/animation_window.jpg\" alt=\"Animation Window\" title=\"Animation Window\">\n<p>Then, give it a name as ‘Idle’. This clip will be our idle animation.</p>\n<img src=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/animation_window_creation.jpg\" alt=\"Animation Creation Window\" title=\"Animation Creation Window\">\n<p>Next, see picture below.</p>\n<img src=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/animation_window.jpg\" alt=\"Animation Window\" title=\"Animation Window\">\n<p>If you come from unity or you understand about animating, this will be not really hard. Idle animation only needs 1 frame. Select the sprite node and see at Inspector. Do you notice it? There is a <strong>key</strong> button on the right side each option. Find <strong>Frame</strong> option and make sure the value is <strong>0</strong>, then click the key (This action called as keyframe). As I said, idle only need 1 frame, leave it like that. Don’t forget to activate the <strong>Auto-play</strong> option (The button right after Animation name).</p>\n<img src=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/idle.gif\" alt=\"Animation Idle\" title=\"Animation Idle\">\n<h3 id=\"Move\"><a href=\"#Move\" class=\"headerlink\" title=\"Move\"></a>Move</h3><p>Next, create a new animation clip called ‘Move’. ‘Move’ animation using 4 frames (0, 1, 2, 11), and the frame will change each 0.15 sec, set it into step (step = 0.15). So the length must be 0.75, this value is from <strong>total_frame &#42; step</strong>. Don’t forget to activate the <strong>loop</strong> option (The button right after step). Now our job is keyframing, select sprite node again, and keyframing!! See image below how I’ve done it.</p>\n<img src=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/move.gif\" alt=\"Animation Move\" title=\"Animation Move\">\n<h3 id=\"Jump\"><a href=\"#Jump\" class=\"headerlink\" title=\"Jump\"></a>Jump</h3><p>I’m sure I don’t need to explain this over again, the jump is like idle, only need 1 frame, and the index frame is <strong>11</strong>. See image below how I’ve done it</p>\n<img src=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/jump.gif\" alt=\"Animation Jump\" title=\"Animation Jump\">\n<div class=\"alert info\"><p>Sorry, but explaining how UI works from text is really hard. I think video will be good for this.</p>\n</div>\n<h3 id=\"Implements-the-Animation-into-Code\"><a href=\"#Implements-the-Animation-into-Code\" class=\"headerlink\" title=\"Implements the Animation into Code\"></a>Implements the Animation into Code</h3><p>Add 2 new variable <code>var last_anim = &quot;&quot;</code> and <code>onready var anim = get_node(&quot;anim&quot;)</code>. Then, add this code at the last line inside of <code>_fixed_process</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\">#other code</span></div><div class=\"line\">\tsprite.set_flip_h(facing_dir != <span class=\"number\">1</span>)</div><div class=\"line\"></div><div class=\"line\">\tvar new_anim = <span class=\"string\">\"Idle\"</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> last_frame_grounded:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> velocity.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tnew_anim = <span class=\"string\">\"Move\"</span></div><div class=\"line\">\t<span class=\"keyword\">else</span></div><div class=\"line\">\t\tnew_anim = <span class=\"string\">\"Jump\"</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">#apply animation</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> new_anim != last_anim:</div><div class=\"line\">\t\tanim.play(new_anim)</div><div class=\"line\">\t\tlast_anim = new_anim</div><div class=\"line\"><span class=\"comment\">#other code</span></div></pre></td></tr></table></figure>\n<div class=\"alert info\"><p><strong>TLDR</strong>, if grounded and velocity.x not 0, then set move. If velocity.y not 0, then set jump, otherwise just idle.</p>\n</div>\n<p><code>last_anim</code> store our last frame animation played. <code>new_anim</code> store what animation will be played in the current frame. If the character grounded and velocity is not 0, then <code>new_anim</code> set as Move. If not grounded, then set the <code>new_anim</code> as jump. Then, we need to check if our last frame animation is not equal as new animation, if the condition meets, then play the animation.</p>\n<img src=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/animation.gif\" alt=\"Animation\" title=\"Animation\">\n<p>This is the full code of player.gd</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends KinematicBody2D</div><div class=\"line\"><span class=\"comment\"># defines GRAVITY</span></div><div class=\"line\"><span class=\"comment\"># `export` makes your variable editable in the editor</span></div><div class=\"line\"><span class=\"comment\"># `var GRAVITY = 10` defines a variable named GRAVITY and assign it 10</span></div><div class=\"line\">export var GRAVITY = <span class=\"number\">10</span></div><div class=\"line\"><span class=\"comment\"># set the maximum falling speed per frame</span></div><div class=\"line\">export var MAX_FALLING_SPEED = <span class=\"number\">15</span></div><div class=\"line\"><span class=\"comment\"># MOVE_SPEED</span></div><div class=\"line\">export var MOVE_SPEED = <span class=\"number\">5</span></div><div class=\"line\">export var MOVE_SPEED_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var move_step = <span class=\"number\">0</span></div><div class=\"line\">export var DECELERATION_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var dec_step = <span class=\"number\">0</span></div><div class=\"line\"><span class=\"comment\"># jump power</span></div><div class=\"line\">export var MAX_JUMP_POWER = <span class=\"number\">5</span></div><div class=\"line\">export var MIN_JUMP_POWER = <span class=\"number\">2</span></div><div class=\"line\">export var MAX_AIR_JUMP_POWER = <span class=\"number\">3</span></div><div class=\"line\">export var MIN_AIR_JUMP_POWER = <span class=\"number\">1</span></div><div class=\"line\">export var MAX_AIR_JUMP_COUNT = <span class=\"number\">2</span></div><div class=\"line\"><span class=\"comment\"># store the player velocity</span></div><div class=\"line\">var velocity = Vector2()</div><div class=\"line\"><span class=\"comment\"># store status of jump input</span></div><div class=\"line\">var is_jump_pressed = false</div><div class=\"line\"><span class=\"comment\"># store status if last frame grounded</span></div><div class=\"line\">var last_frame_grounded = false</div><div class=\"line\"><span class=\"comment\">#store jump counter</span></div><div class=\"line\">var air_jump_count = <span class=\"number\">0</span></div><div class=\"line\">var facing_dir = <span class=\"number\">1</span></div><div class=\"line\">var last_anim = <span class=\"string\">\"\"</span></div><div class=\"line\">onready var anim = get_node(<span class=\"string\">\"anim\"</span>)</div><div class=\"line\"></div><div class=\"line\">onready var sprite = get_node(<span class=\"string\">\"Sprite\"</span>)</div><div class=\"line\"><span class=\"comment\"># Called when the node is \"ready\", that means called when the game started.</span></div><div class=\"line\"><span class=\"comment\"># Use this function for initialize</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\tmove_step = MOVE_SPEED / MOVE_SPEED_TIME_NEEDED</div><div class=\"line\">\tdec_step = MOVE_SPEED / DECELERATION_TIME_NEEDED</div><div class=\"line\">\tlast_anim = anim.get_current_animation()</div><div class=\"line\">\t<span class=\"comment\"># makes `_fixed_process(delta)` running</span></div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called during the fixed processing step of the main loop.</span></div><div class=\"line\"><span class=\"comment\"># Fixed processing means that the frame rate is synced to the physics,</span></div><div class=\"line\"><span class=\"comment\"># i.e. the delta variable should be constant.</span></div><div class=\"line\"><span class=\"comment\"># only active when set_fixed_process(true) is called</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(velocity.x, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\">#input</span></div><div class=\"line\">\tvar right_input = Input.is_action_pressed(<span class=\"string\">\"right\"</span>)</div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\">\tvar jump_input = Input.is_action_pressed(<span class=\"string\">\"jump\"</span>)</div><div class=\"line\">\t<span class=\"comment\">#Apply the horizontal movement</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> right_input:</div><div class=\"line\">\t\tmovement.x += move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> left_input:</div><div class=\"line\">\t\tmovement.x -= move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> movement.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\t<span class=\"comment\">#get the direction of movement</span></div><div class=\"line\">\t\tvar _dir = sign(movement.x)</div><div class=\"line\">\t\t<span class=\"comment\">#calculate deceleration amount and direction</span></div><div class=\"line\">\t\tvar _dec = _dir * <span class=\"number\">-1</span> * dec_step * delta</div><div class=\"line\">\t\t<span class=\"comment\"># apply to movement</span></div><div class=\"line\">\t\tmovement.x += _dec</div><div class=\"line\">\t\t<span class=\"comment\"># stop it when reached 0</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span> _dir == <span class=\"number\">1</span> &amp;&amp; movement.x &lt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> _dir == <span class=\"number\">-1</span> &amp;&amp; movement.x &gt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t<span class=\"comment\">#if the movement.x more that max_speed, gap it</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(movement.x) &gt; MOVE_SPEED:</div><div class=\"line\">\t\tmovement.x = sign(movement.x) * MOVE_SPEED</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">#Apply jumping</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> jump_input:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> !is_jump_pressed &amp;&amp; last_frame_grounded:</div><div class=\"line\">\t\t\tmovement.y = -MAX_JUMP_POWER</div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> !is_jump_pressed &amp;&amp; !last_frame_grounded &amp;&amp; air_jump_count &lt; MAX_AIR_JUMP_COUNT:</div><div class=\"line\">\t\t\tmovement.y = -MAX_AIR_JUMP_POWER</div><div class=\"line\">\t\t\tair_jump_count += <span class=\"number\">1</span></div><div class=\"line\">\t\tis_jump_pressed = true</div><div class=\"line\">\t<span class=\"keyword\">elif</span> !jump_input &amp;&amp; is_jump_pressed:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> air_jump_count != <span class=\"number\">0</span> &amp;&amp; movement.y &lt; -MIN_AIR_JUMP_POWER:</div><div class=\"line\">\t\t\tmovement.y = -MIN_AIR_JUMP_POWER</div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> movement.y &lt; -MIN_JUMP_POWER:</div><div class=\"line\">\t\t\tmovement.y = -MIN_JUMP_POWER</div><div class=\"line\">\t\tis_jump_pressed = false</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\">\t<span class=\"comment\"># set the maximum falling speed</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.y &gt; MAX_FALLING_SPEED:</div><div class=\"line\">\t\tvelocity.y = MAX_FALLING_SPEED</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\"># apply the movement by calling move(velocity) and store the remaining movement</span></div><div class=\"line\">\tvar remaining_movement = move(velocity)</div><div class=\"line\">\t<span class=\"comment\"># collision handling</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> is_colliding():</div><div class=\"line\">\t\tvar normal = get_collision_normal()</div><div class=\"line\"></div><div class=\"line\">\t\tremaining_movement = normal.slide(remaining_movement)</div><div class=\"line\">\t\tvelocity = normal.slide(velocity)</div><div class=\"line\">\t\tmove(remaining_movement)</div><div class=\"line\">\t\t<span class=\"comment\"># if normal is floor, then set as grounded</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span> normal == Vector2(<span class=\"number\">0</span>, <span class=\"number\">-1</span>):</div><div class=\"line\">\t\t\tlast_frame_grounded = true</div><div class=\"line\">\t\t\tair_jump_count = <span class=\"number\">0</span></div><div class=\"line\">\t<span class=\"keyword\">elif</span> last_frame_grounded:</div><div class=\"line\">\t\tlast_frame_grounded = false</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\tfacing_dir = sign(velocity.x)</div><div class=\"line\"></div><div class=\"line\">\tsprite.set_flip_h(facing_dir != <span class=\"number\">1</span>)</div><div class=\"line\"></div><div class=\"line\">\tvar new_anim = <span class=\"string\">\"Idle\"</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> last_frame_grounded:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> velocity.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tnew_anim = <span class=\"string\">\"Move\"</span></div><div class=\"line\">\t<span class=\"keyword\">else</span>:</div><div class=\"line\">\t\tnew_anim = <span class=\"string\">\"Jump\"</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">#apply animation</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> new_anim != last_anim:</div><div class=\"line\">\t\tanim.play(new_anim)</div><div class=\"line\">\t\tlast_anim = new_anim</div><div class=\"line\"></div><div class=\"line\">func get_center_pos():</div><div class=\"line\">\t<span class=\"keyword\">return</span> get_pos() + get_node(<span class=\"string\">\"CollisionShape2D\"</span>).get_pos()</div></pre></td></tr></table></figure>\n<p>Today that is enough, the next part will be parallax background, stay tuned!</p>\n<p><a href=\"https://github.com/damarindra/2D-Platformer-Godot\" target=\"_blank\" rel=\"external\">Download Project Here</a></p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>","categories":["godot","tutorial","tutorial_platformer"],"tags":["Godot","gamedev","game","development","platformer"]},{"title":"Tilemap and Camera - Platformer Tutorial Part 4 - Godot","url":"http://damarindra.com/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/","content":"<div class=\"spoiler collapsed\"><div class=\"spoiler-title\">Table of Content</div><div class=\"spoiler-content\"><!-- toc --></div></div>\n<p>This is the fourth part of the tutorial creating platformer game on Godot Engine. In this tutorial I will explain how to setup tilemap and camera.<br><a id=\"more\"></a></p>\n<ol>\n<li><a href=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/\" title=\"Part 1 : Preparation\">Part 1 : Preparation</a></li>\n<li><a href=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/\" title=\"Part 2 : Player Creation\">Part 2 : Player Creation</a></li>\n<li><a href=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/\" title=\"Part 3 : Player Creation 2\">Part 3 : Player Creation 2</a></li>\n<li><strong>Part 4 : Tilemap and Camera</strong></li>\n<li><a href=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/\" title=\"Part 5 : Player Animation\">Part 5 : Player Animation</a></li>\n<li><a href=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/\" title=\"Part 6 : Parallax Background and Level Bounds\">Part 6 : Parallax Background and Level Bounds</a>\n</li>\n</ol>\n<h2 id=\"Tileset-and-Tilemap\"><a href=\"#Tileset-and-Tilemap\" class=\"headerlink\" title=\"Tileset and Tilemap\"></a>Tileset and Tilemap</h2><p>Godot has a special tilemap node, so we don’t need 3rd party software like Tiled to make our level. Create and setup tilemap is not that hard, what you need to do is just create new scene and fill it with bunch of node for the tileset.</p>\n<h3 id=\"Tileset\"><a href=\"#Tileset\" class=\"headerlink\" title=\"Tileset\"></a>Tileset</h3><p>Before we go into level design, we need to make our tileset. Create a new scene and create a Node2D (rename to “Tileset”) as the root. Then create a sprite node as a child of <em>Tileset</em>. So we have 2 node, one is <strong>Tileset</strong> and the other one is <strong>Sprite</strong>. Each child of <strong>Tileset</strong> will become <strong>tiles</strong> (only sprite node) and the name of sprite node will become the <strong>ID</strong>. Rename the sprite into “0”.</p>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/tilemap_structure.jpg\" alt=\"Tilemap Scene\" title=\"Tilemap Scene\">\n<p>I want to create my first tile with the <em>left top ground</em>, assign the Texture with Tiles.png, set the <strong>VFrames = 20</strong> and <strong>HFrames = 22</strong>. Set the sprite into “left top ground” image by changing the <strong>Frame = 79</strong>. So we got our first tile.</p>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/assign_sprite.gif\" alt=\"Setup Tiles 0\" title=\"Setup Tiles 0\">\n<p>This tile is ground type, which means need a collision. The collision is static, so, add a new StaticBody2D Node as a child of “0”. Then add a new CollisionShape2D as a child of StaticBody2D. Set the CollisionShape2D with RectangleShape2D and setup the size of RectangleShape2D along with the size of ground sprite.</p>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/setup_collision.gif\" alt=\"Setup Collision Tiles 0\" title=\"Setup Collision Tiles 0\">\n<div class=\"alert info\"><p><strong>PRO TIPS</strong> : You can edit collision shape into precise value by activating the Snap Option. Click <em>Edit - Use Snap</em>, setup the snap value by clicking <em>Edit - Configure Snap</em>.</p>\n</div>\n<p>Okay, we are done with one tile, 12 left! You can duplicate the node by pressing CTRL + D and setup it as needed, until you got all this tileset</p>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/setup_tileset.gif\" alt=\"Setup Tileset\" title=\"Setup Tileset\">\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/all_tileset.jpg\" alt=\"All Tiles\" title=\"All Tiles\">\n<p>Save the scene as Tileset.tscn, then click <em>Scene - Convert To.. - Tileset</em>, save it as tileset.tres make sure enable Merge With Existing Option. Yeay, we’ve done creating the Tileset.</p>\n<h3 id=\"Tilemap\"><a href=\"#Tilemap\" class=\"headerlink\" title=\"Tilemap\"></a>Tilemap</h3><p>We’ve create the tileset, now we can create our World level. Open World.tscn delete our <em>StaticBody2D</em> Node and create a Tilemap Node. View at Inspector Window, find Tile Set option, click the <em><null></null></em> button, and select <em>Load</em>, navigate to our tileset.tres file. Because our tiles size is 16x16 px so we need to change the Cell Size. Find option <strong>Size</strong> inside <em>Cell</em> section, change it into (16, 16).</p>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/tilemap_option.jpg\" alt=\"Tilemap\" title=\"Tilemap\">\n<p>Now create a simple level! Left click to paint, right click to delete.</p>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/world_creation.gif\" alt=\"Setup World\" title=\"Setup World\">\n<div class=\"alert info\"><p><strong>PRO TIPS</strong> : In my tileset view maybe different from yours, you can configure it in TileMap Editor Settings. Click <em>Settings - Editor Settings - Tilemap - Change the value as you wish</em>.</p>\n</div>\n<h2 id=\"Camera\"><a href=\"#Camera\" class=\"headerlink\" title=\"Camera\"></a>Camera</h2><p>Camera will always follow the player. But how? You can easily set the camera node as a child of Player, but that just dirty trick and not pleasing in the eyes. Or you can use Drag Margin (found in inspector), but I don’t like it, however it’s easy and good. If you using Drag Margin, when you moving on the right direction, the camera will be on the left of character, and otherwise. That makes user can’t see clearly what happen in the next area, because the camera always left behind the character. That was Drag Margin and that was opposite of my implementation. If the character moving right direction, I want the camera is on the right side, so user can see clearly in the next area, hope you understand what I mean :). Here you go example of using Drag Margin</p>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/drag_margin.gif\" alt=\"Camera Drag Margin\" title=\"Camera Drag Margin\">\n<div class=\"alert info\"><p><strong>PRO TIPS</strong> : As far as I know, godot automatically set pixel perfect for you (make sure your sprite import flags disabled). So, the camera movement must be not <strong>floating point</strong>. Image above is not good for pixel art, because the camera position will be at floating point. If you really need the camera at floating point, you can activate in <strong>use_2d_pixel_snap</strong> inside <em>Project Setting - Display</em>, this will force the render result always pixel perfect, but the result maybe little weird, in my opinion of course.</p>\n</div>\n<h3 id=\"Configure-Display-Settings\"><a href=\"#Configure-Display-Settings\" class=\"headerlink\" title=\"Configure Display Settings\"></a>Configure Display Settings</h3><p>So, before we go into coding, we need to modify our display settings at <strong>Project Setting</strong>. Open <strong>Project Setting</strong> by clicking <em>Scene - Project Setting - Display</em>. Now change the <strong>width</strong> = 160, <strong>height</strong> = 86, <strong>stretch_mode</strong> = viewport, <strong>stretch_aspect</strong> = keep_height and <strong>use_2d_pixel_snap</strong> = on.</p>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/display_project_settings.jpg\" alt=\"Project Setting - Display\" title=\"Project Setting - Display\">\n<h3 id=\"Scripting-Camera\"><a href=\"#Scripting-Camera\" class=\"headerlink\" title=\"Scripting Camera\"></a>Scripting Camera</h3><p>Modify Camera2D option in Inspector by disabling the <strong>H Enabled</strong> and <strong>V Enabled</strong>, and set the <em>Smoothing <strong>Speed</strong> </em> to 0. You can play a bit with <strong>Offset</strong> value, my setup is (0, -20).</p>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/camera_option.jpg\" alt=\"Camera Settings\" title=\"Camera Settings\">\n<p>Create a new script and attach into Camera2D, save it as camera.gd, and write the code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends Camera2D</div><div class=\"line\"></div><div class=\"line\">export var target = <span class=\"string\">\"../Player\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># onready prefix : Initializes a variable once the Node the script is attached to and its children are part of the scene tree.</span></div><div class=\"line\">onready var target_node = get_node(target)</div><div class=\"line\"></div><div class=\"line\">func _ready():</div><div class=\"line\">\t<span class=\"comment\"># window maximized, comment this line code if you don't want to automatically maximized</span></div><div class=\"line\">\tOS.set_window_maximized(true)</div><div class=\"line\">\tvar pos = target_node.get_pos()</div><div class=\"line\">\t<span class=\"comment\"># forcing set the position into character position</span></div><div class=\"line\">\tpos = Vector2(round(pos.x), round(pos.y))</div><div class=\"line\">\tset_pos(pos)</div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># set the position into integer number</span></div><div class=\"line\">\tset_pos(Vector2(round(target_node.get_pos().x), round(target_node.get_pos().y)))</div></pre></td></tr></table></figure>\n<div class=\"alert info\"><p><code>onready</code> will initializes the variable when the node is ready, including the child of node</p>\n</div>\n<p>As I said before, we make the camera position value into integer number (ex 1, 2, 3, 10), so we need to call <strong>round</strong> to make it integer.</p>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/camera_basic.gif\" alt=\"Camera Follow\" title=\"Camera Follow\">\n<h3 id=\"Add-New-Code-into-Player-Script\"><a href=\"#Add-New-Code-into-Player-Script\" class=\"headerlink\" title=\"Add New Code into Player Script\"></a>Add New Code into Player Script</h3><p>The camera always follow the player and the position is always same as player position, that was not what we want to achieve. The camera will in front of player, but how to know the character direction? currently we don’t have it, so modify our <strong>player script</strong>. Add a new variable called <code>var facing_dir = 1</code> and modify our code at the end of <code>func _fixed_process(delta)</code> and add one new function to get the real center position</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\">#other code</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\tfacing_dir = sign(velocity.x)</div><div class=\"line\"></div><div class=\"line\">func get_center_pos():</div><div class=\"line\">\t<span class=\"keyword\">return</span> get_pos() + get_node(<span class=\"string\">\"CollisionShape2D\"</span>).get_pos()</div></pre></td></tr></table></figure>\n<h3 id=\"Interpolate-the-Camera-Movement\"><a href=\"#Interpolate-the-Camera-Movement\" class=\"headerlink\" title=\"Interpolate the Camera Movement\"></a>Interpolate the Camera Movement</h3><p>Now, we have information about player direction and the real center position. Back to camera.gd script and create 2 new variable called <code>export var forward_offset = 60</code> and <code>export var x_smoothing = .05</code>, then modify our code into like this.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends Camera2D</div><div class=\"line\"></div><div class=\"line\">export var target = <span class=\"string\">\"../Player\"</span></div><div class=\"line\">export var forward_offset = <span class=\"number\">60</span></div><div class=\"line\">export var x_smoothing = <span class=\"number\">.05</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># onready prefix : Initializes a variable once the Node the script is attached to and its children are part of the scene tree.</span></div><div class=\"line\">onready var target_node = get_node(target)</div><div class=\"line\"></div><div class=\"line\">func _ready():</div><div class=\"line\">\t<span class=\"comment\"># window maximized, comment this line code if you don't want to automatically maximized</span></div><div class=\"line\">\tOS.set_window_maximized(true)</div><div class=\"line\">\tvar pos = target_node.get_pos()</div><div class=\"line\">\t<span class=\"comment\"># forcing set the position into character position</span></div><div class=\"line\">\tpos = Vector2(round(pos.x), round(pos.y))</div><div class=\"line\">\tset_pos(pos)</div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\tvar target_pos = target_node.get_center_pos() + Vector2(<span class=\"number\">1</span>, <span class=\"number\">0</span>) * target_node.facing_dir * forward_offset</div><div class=\"line\">\t<span class=\"comment\"># smoothing the movement</span></div><div class=\"line\">\ttarget_pos.x = lerp(get_pos().x, target_pos.x, x_smoothing)</div><div class=\"line\">\t<span class=\"comment\">#gap it when the next position is out of bound</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(target_pos.x - target_node.get_center_pos().x) &gt; forward_offset:</div><div class=\"line\">\t\ttarget_pos.x = target_node.get_center_pos().x + target_node.facing_dir * forward_offset * <span class=\"number\">-1</span></div><div class=\"line\">\t<span class=\"comment\"># set the position into integer number</span></div><div class=\"line\">\tset_pos(Vector2(round(target_pos.x), round(target_pos.y)))</div></pre></td></tr></table></figure>\n<div class=\"alert info\"><p><code>lerp</code> also called as Linear Interpolation. When calling lerp(from, to, weight), if weight = 0 will return same as <strong>from</strong>, and if weight = 1 will return same as <strong>to</strong></p>\n</div>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/camera_x.gif\" alt=\"Camera Follow X Interpolation\" title=\"Camera Follow X Interpolation\">\n<p>Now, the camera position will in front of player position. Now, let’s interpolate the y axis, create 2 new variable <code>export var max_y_offset = 5</code> and <code>export var y_smoothing = .1</code> and add 3 line code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\">#other code</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(target_pos.x - target_node.get_center_pos().x) &gt; forward_offset:</div><div class=\"line\">\t\ttarget_pos.x = target_node.get_center_pos().x + target_node.facing_dir * forward_offset * <span class=\"number\">-1</span></div><div class=\"line\"></div><div class=\"line\">\ttarget_pos.y = lerp(get_pos().y, target_pos.y + max_y_offset, y_smoothing)</div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(target_pos.y - target_node.get_center_pos().y) &gt; max_y_offset:</div><div class=\"line\">\t\ttarget_pos.y =  target_node.get_center_pos().y + (sign(target_pos.y - target_node.get_center_pos().y) * max_y_offset)</div><div class=\"line\"></div><div class=\"line\">\tset_pos(Vector2(round(target_pos.x), round(target_pos.y)))</div></pre></td></tr></table></figure>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/camera_y.gif\" alt=\"Camera Follow Y Interpolation\" title=\"Camera Follow Y Interpolation\">\n<p>Done! This is the final code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends Camera2D</div><div class=\"line\"></div><div class=\"line\">export var target = <span class=\"string\">\"../Player\"</span></div><div class=\"line\">export var forward_offset = <span class=\"number\">60</span></div><div class=\"line\">export var max_y_offset = <span class=\"number\">5</span></div><div class=\"line\">export var x_smoothing = <span class=\"number\">.05</span></div><div class=\"line\">export var y_smoothing = <span class=\"number\">.1</span></div><div class=\"line\"></div><div class=\"line\">onready var target_node = get_node(target)</div><div class=\"line\"></div><div class=\"line\">func _ready():</div><div class=\"line\">\tOS.set_window_maximized(true)</div><div class=\"line\">\tvar pos = target_node.get_pos()</div><div class=\"line\">\tpos = Vector2(round(pos.x), round(pos.y))</div><div class=\"line\">\tset_pos(pos)</div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\tvar target_pos = target_node.get_center_pos() + Vector2(<span class=\"number\">1</span>, <span class=\"number\">0</span>) * target_node.facing_dir * forward_offset</div><div class=\"line\">\ttarget_pos.x = lerp(get_pos().x, target_pos.x, x_smoothing)</div><div class=\"line\">\t<span class=\"comment\">#gap it when the next position is out of bound</span></div><div class=\"line\">\t<span class=\"comment\">#salah</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(target_pos.x - target_node.get_center_pos().x) &gt; forward_offset:</div><div class=\"line\">\t\ttarget_pos.x = target_node.get_center_pos().x + target_node.facing_dir * forward_offset * <span class=\"number\">-1</span></div><div class=\"line\"></div><div class=\"line\">\ttarget_pos.y = lerp(get_pos().y, target_pos.y + max_y_offset, y_smoothing)</div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(target_pos.y - target_node.get_center_pos().y) &gt; max_y_offset:</div><div class=\"line\">\t\ttarget_pos.y =  target_node.get_center_pos().y + (sign(target_pos.y - target_node.get_center_pos().y) * max_y_offset)</div><div class=\"line\"></div><div class=\"line\">\tset_pos(Vector2(round(target_pos.x), round(target_pos.y)))</div></pre></td></tr></table></figure>\n<p>My player script variables values has been changed, if you want to follow my setup, here we go. You can also playing a bit with script variables, don’t be scared about that</p>\n<img src=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/player_script_variables.jpg\" alt=\"Player Script Variables\" title=\"Player Script Variables\">\n<div class=\"alert info\"><p>Make sure your <strong>camera</strong> always at the last order from another node.</p>\n</div>\n<p>Next part, we will setup our <a href=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/\" title=\"setup our player again, animation, direction and other stuff\">setup our player again, animation, direction and other stuff</a> for the next part</p>\n<p><a href=\"https://github.com/damarindra/2D-Platformer-Godot\" target=\"_blank\" rel=\"external\">Download Project Here</a></p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>","categories":["godot","tutorial","tutorial_platformer"],"tags":["Godot","gamedev","game","development","platformer"]},{"title":"Player Creation 2 - Platformer Tutorial Part 3 - Godot","url":"http://damarindra.com/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/","content":"<div class=\"spoiler collapsed\"><div class=\"spoiler-title\">Table of Content</div><div class=\"spoiler-content\"><!-- toc --></div></div>\n<p>This is the third part of the tutorial creating platformer game on Godot Engine. In this tutorial will refine our character movement and how to make the character jumping. So let’s get started!<br><a id=\"more\"></a></p>\n<ol>\n<li><a href=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/\" title=\"Part 1 : Preparation\">Part 1 : Preparation</a></li>\n<li><a href=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/\" title=\"Part 2 : Player Creation\">Part 2 : Player Creation</a></li>\n<li><strong>Part 3 : Player Creation 2</strong></li>\n<li><a href=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/\" title=\"Part 4 : Tilemap and Camera\">Part 4 : Tilemap and Camera</a></li>\n<li><a href=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/\" title=\"Part 5 : Player Animation\">Part 5 : Player Animation</a></li>\n<li><a href=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/\" title=\"Part 6 : Parallax Background and Level Bounds\">Part 6 : Parallax Background and Level Bounds</a>\n</li>\n</ol>\n<h2 id=\"Refining-the-Character-movement\"><a href=\"#Refining-the-Character-movement\" class=\"headerlink\" title=\"Refining the Character movement\"></a>Refining the Character movement</h2><p>Current method will move directly by <code>MOVE_SPEED</code> without any smoothing (low to high).</p>\n<h3 id=\"Acceleration\"><a href=\"#Acceleration\" class=\"headerlink\" title=\"Acceleration\"></a>Acceleration</h3><p>The idea is, if you have play super mario, the character movement is started from low until reaching the max speed. We will do it like that, so add a new variable called <code>export var MOVE_SPEED_TIME_NEEDED = .15</code>. This variable will determine how long character need to reach <code>MOVE_SPEED</code>, in this case is .15 second. Next one, add a new variable <code>var move_step</code>. Then modify our code into like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\tmove_step = MOVE_SPEED / MOVE_SPEED_TIME_NEEDED</div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(velocity.x, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\">#input</span></div><div class=\"line\">\tvar right_input = Input.is_action_pressed(<span class=\"string\">\"right\"</span>)</div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\">\t<span class=\"comment\">#Apply the horizontal movement</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> right_input:</div><div class=\"line\">\t\tmovement.x += move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> left_input:</div><div class=\"line\">\t\tmovement.x -= move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">else</span>:</div><div class=\"line\">\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t<span class=\"comment\">#if the movement.x more that max_speed, gap it</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(movement.x) &gt; MOVE_SPEED:</div><div class=\"line\">\t\tmovement.x = sign(movement.x) * MOVE_SPEED</div><div class=\"line\"><span class=\"comment\">#other code</span></div></pre></td></tr></table></figure>\n<p>Because we use real time calculation (.15 second) then don’t forget to multiply by delta. Okay, maybe some of you will be confused with <code>abs</code> and <code>sign</code>.</p>\n<div class=\"alert info\"><p><code>abs</code> is absolute, that means always return a positive value. For example, the movement.x = -2, then call abs(movement.x) will return 2, but the movement.x still -2 because we don’t assign it.</p>\n<p><code>sign</code> will return -1 or 1, depending on the value. If the value is less than 0, then return -1, and otherwise.</p>\n</div>\n<p>A simple explanation about that code which implements abs and sign is, if the absolute value of movement.x (always positive) more than MOVE_SPEED, then set the movement.x with the sign of movement.x (if movement.x less than 0, then return -1 and moving left, and otherwise) multiply by MOVE_SPEED.</p>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/acceleration.gif\" alt=\"Acceleration\" title=\"Acceleration\">\n<h3 id=\"Deceleration\"><a href=\"#Deceleration\" class=\"headerlink\" title=\"Deceleration\"></a>Deceleration</h3><p>When the horizontal input is pressed, the character movement is smooth now, but, when the button is up (unpressed), the character will stop immediately, this is weird right? So, we need to add the deceleration too. Add 2 variable <code>export var DECELERATION_TIME_NEEDED = .15</code> and <code>var dec_step</code>. Then modify our code into like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\tmove_step = MOVE_SPEED / MOVE_SPEED_TIME_NEEDED</div><div class=\"line\">\tdec_step = MOVE_SPEED / DECELERATION_TIME_NEEDED</div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\">#other code</span></div><div class=\"line\">\t<span class=\"comment\">#Apply the horizontal movement</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> right_input:</div><div class=\"line\">\t\tmovement.x += move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> left_input:</div><div class=\"line\">\t\tmovement.x -= move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> movement.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\t<span class=\"comment\">#get the direction of movement</span></div><div class=\"line\">\t\tvar _dir = sign(movement.x)</div><div class=\"line\">\t\t<span class=\"comment\">#calculate deceleration amount and direction</span></div><div class=\"line\">\t\tvar _dec = _dir * <span class=\"number\">-1</span> * dec_step * delta</div><div class=\"line\">\t\t<span class=\"comment\"># apply to movement</span></div><div class=\"line\">\t\tmovement.x += _dec</div><div class=\"line\">\t\t<span class=\"comment\"># stop it when reached 0</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span> _dir == <span class=\"number\">1</span> &amp;&amp; movement.x &lt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> _dir == <span class=\"number\">-1</span> &amp;&amp; movement.x &gt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\"><span class=\"comment\">#other code</span></div></pre></td></tr></table></figure>\n<p><strong>Explanation</strong> : So, when right or left input not pressed and movement.x is not zero, then we need to decelerate the movement. First, we need to get the direction of movement by doing sign(movement.x). So we know where the direction for deceleration (sign(movement.x) &#42; -1). Then calculate the deceleration amount with sign(movement.x) &#42; -1 &#42; dec_step &#42; delta. Then just apply to the movement. Also, don’t forget to stop it when reaching the 0 point.</p>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/deceleration.gif\" alt=\"Deceleration\" title=\"Deceleration\">\n<p>Final code will looks like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends KinematicBody2D</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># defines GRAVITY</span></div><div class=\"line\"><span class=\"comment\"># `export` makes your variable editable in the editor</span></div><div class=\"line\"><span class=\"comment\"># `var GRAVITY = 10` defines a variable named GRAVITY and assign it 10</span></div><div class=\"line\">export var GRAVITY = <span class=\"number\">10</span></div><div class=\"line\"><span class=\"comment\"># set the maximum falling speed per frame</span></div><div class=\"line\">export var MAX_FALLING_SPEED = <span class=\"number\">15</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># MOVE_SPEED</span></div><div class=\"line\">export var MOVE_SPEED = <span class=\"number\">5</span></div><div class=\"line\">export var MOVE_SPEED_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var move_step = <span class=\"number\">0</span></div><div class=\"line\">export var DECELERATION_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var dec_step = <span class=\"number\">0</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># store the player velocity</span></div><div class=\"line\">var velocity = Vector2()</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called when the node is \"ready\", that means called when the game started.</span></div><div class=\"line\"><span class=\"comment\"># Use this function for initialize</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\tmove_step = MOVE_SPEED / MOVE_SPEED_TIME_NEEDED</div><div class=\"line\">\tdec_step = MOVE_SPEED / DECELERATION_TIME_NEEDED</div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called during the fixed processing step of the main loop.</span></div><div class=\"line\"><span class=\"comment\"># Fixed processing means that the frame rate is synced to the physics,</span></div><div class=\"line\"><span class=\"comment\"># i.e. the delta variable should be constant.</span></div><div class=\"line\"><span class=\"comment\"># only active when set_fixed_process(true) is called</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(velocity.x, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\">#input</span></div><div class=\"line\">\tvar right_input = Input.is_action_pressed(<span class=\"string\">\"right\"</span>)</div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\">\t<span class=\"comment\">#Apply the horizontal movement</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> right_input:</div><div class=\"line\">\t\tmovement.x += move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> left_input:</div><div class=\"line\">\t\tmovement.x -= move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> movement.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\t<span class=\"comment\">#get the direction of movement</span></div><div class=\"line\">\t\tvar _dir = sign(movement.x)</div><div class=\"line\">\t\t<span class=\"comment\">#calculate deceleration amount and direction</span></div><div class=\"line\">\t\tvar _dec = _dir * <span class=\"number\">-1</span> * dec_step * delta</div><div class=\"line\">\t\t<span class=\"comment\"># apply to movement</span></div><div class=\"line\">\t\tmovement.x += _dec</div><div class=\"line\">\t\t<span class=\"comment\"># stop it when reached 0</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span> _dir == <span class=\"number\">1</span> &amp;&amp; movement.x &lt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> _dir == <span class=\"number\">-1</span> &amp;&amp; movement.x &gt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t<span class=\"comment\">#if the movement.x more that max_speed, gap it</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(movement.x) &gt; MOVE_SPEED:</div><div class=\"line\">\t\tmovement.x = sign(movement.x) * MOVE_SPEED</div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\">\t<span class=\"comment\"># set the maximum falling speed</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.y &gt; MAX_FALLING_SPEED:</div><div class=\"line\">\t\tvelocity.y = MAX_FALLING_SPEED</div><div class=\"line\">\t<span class=\"comment\"># apply the movement by calling move(velocity) and store the remaining movement</span></div><div class=\"line\">\tvar remaining_movement = move(velocity)</div><div class=\"line\">\t<span class=\"comment\"># collision handling</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> is_colliding():</div><div class=\"line\">\t\tvar normal = get_collision_normal()</div><div class=\"line\">\t\tremaining_movement = normal.slide(remaining_movement)</div><div class=\"line\">\t\tvelocity = normal.slide(velocity)</div><div class=\"line\">\t\tmove(remaining_movement)</div></pre></td></tr></table></figure>\n<h2 id=\"Jumping-Implementation\"><a href=\"#Jumping-Implementation\" class=\"headerlink\" title=\"Jumping Implementation\"></a>Jumping Implementation</h2><p>The idea is, when user press jump input, then the character will jumping. The jump height depends on how long user presses the jump input. But we don’t do it at once, I’ll explain it step by step.</p>\n<h3 id=\"Utilize-the-Jump-Input\"><a href=\"#Utilize-the-Jump-Input\" class=\"headerlink\" title=\"Utilize the Jump Input\"></a>Utilize the Jump Input</h3><p>In the <a href=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/\" title=\"part 2\">part 2</a>, we have add jump action at <strong>Input Map</strong>. So, let’s implement it! First of all, add one variable to define jump power.</p>\n<p><code>export var JUMP_POWER = 8</code></p>\n<p>Then add one line code for the input right below after left_input</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\"><span class=\"comment\">#prev code</span></div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\">\tvar jump_input = Input.is_action_pressed(<span class=\"string\">\"jump\"</span>)</div><div class=\"line\"><span class=\"comment\">#next code</span></div></pre></td></tr></table></figure>\n<p>Now, implement the jump ability</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\"><span class=\"comment\">#prev code</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> jump_input:</div><div class=\"line\">\t\tmovement.y = -JUMP_POWER</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\"><span class=\"comment\">#next code</span></div></pre></td></tr></table></figure>\n<p>If you try, whenever you pressed jump key, the character always go up, until you release jump key. Don’t worry, your code not error, because the code says like that.</p>\n<div class=\"alert info\"><p><code>movement.y = -JUMP_POWER</code>, don’t forget the up direction is <strong>negative</strong>!!!</p>\n</div>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/jump_input.gif\" alt=\"Utilize Jump Input\" title=\"Utilize Jump Input\">\n<h3 id=\"Fixing-Jump-Method\"><a href=\"#Fixing-Jump-Method\" class=\"headerlink\" title=\"Fixing Jump Method\"></a>Fixing Jump Method</h3><p>Weird?? Don’t worry, no error for now, because our code says like that. Our input is triggered whenever the user presses the jump button. So, our movement.y always same as JUMP_POWER. So we need to make the character only jump when the user pressed down the jump button. Add one more variable</p>\n<p><code>var is_jump_pressed = false</code></p>\n<p>Then modify our implementation</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\"><span class=\"comment\">#prev code</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> jump_input:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> !is_jump_pressed:</div><div class=\"line\">\t\t\tmovement.y = -JUMP_POWER</div><div class=\"line\">\t\tis_jump_pressed = true</div><div class=\"line\">\t<span class=\"keyword\">elif</span> !jump_input &amp;&amp; is_jump_pressed:</div><div class=\"line\">\t\tis_jump_pressed = false</div><div class=\"line\"><span class=\"comment\">#next code</span></div></pre></td></tr></table></figure>\n<p>Here the full code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends KinematicBody2D</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># defines GRAVITY</span></div><div class=\"line\"><span class=\"comment\"># `export` makes your variable editable in the editor</span></div><div class=\"line\"><span class=\"comment\"># `var GRAVITY = 10` defines a variable named GRAVITY and assign it 10</span></div><div class=\"line\">export var GRAVITY = <span class=\"number\">10</span></div><div class=\"line\"><span class=\"comment\"># set the maximum falling speed per frame</span></div><div class=\"line\">export var MAX_FALLING_SPEED = <span class=\"number\">15</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># MOVE_SPEED</span></div><div class=\"line\">export var MOVE_SPEED = <span class=\"number\">5</span></div><div class=\"line\">export var MOVE_SPEED_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var move_step = <span class=\"number\">0</span></div><div class=\"line\">export var DECELERATION_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var dec_step = <span class=\"number\">0</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># jump power</span></div><div class=\"line\">export var JUMP_POWER = <span class=\"number\">5</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># store the player velocity</span></div><div class=\"line\">var velocity = Vector2()</div><div class=\"line\"><span class=\"comment\"># store status of jump input</span></div><div class=\"line\">var is_jump_pressed = false</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called when the node is \"ready\", that means called when the game started.</span></div><div class=\"line\"><span class=\"comment\"># Use this function for initialize</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\tmove_step = MOVE_SPEED / MOVE_SPEED_TIME_NEEDED</div><div class=\"line\">\tdec_step = MOVE_SPEED / DECELERATION_TIME_NEEDED</div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called during the fixed processing step of the main loop.</span></div><div class=\"line\"><span class=\"comment\"># Fixed processing means that the frame rate is synced to the physics,</span></div><div class=\"line\"><span class=\"comment\"># i.e. the delta variable should be constant.</span></div><div class=\"line\"><span class=\"comment\"># only active when set_fixed_process(true) is called</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(velocity.x, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\">#input</span></div><div class=\"line\">\tvar right_input = Input.is_action_pressed(<span class=\"string\">\"right\"</span>)</div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\">\tvar jump_input = Input.is_action_pressed(<span class=\"string\">\"jump\"</span>)</div><div class=\"line\">\t<span class=\"comment\">#Apply the horizontal movement</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> right_input:</div><div class=\"line\">\t\tmovement.x += move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> left_input:</div><div class=\"line\">\t\tmovement.x -= move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> movement.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\t<span class=\"comment\">#get the direction of movement</span></div><div class=\"line\">\t\tvar _dir = sign(movement.x)</div><div class=\"line\">\t\t<span class=\"comment\">#calculate deceleration amount and direction</span></div><div class=\"line\">\t\tvar _dec = _dir * <span class=\"number\">-1</span> * dec_step * delta</div><div class=\"line\">\t\t<span class=\"comment\"># apply to movement</span></div><div class=\"line\">\t\tmovement.x += _dec</div><div class=\"line\">\t\t<span class=\"comment\"># stop it when reached 0</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span> _dir == <span class=\"number\">1</span> &amp;&amp; movement.x &lt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> _dir == <span class=\"number\">-1</span> &amp;&amp; movement.x &gt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t<span class=\"comment\">#if the movement.x more that max_speed, gap it</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(movement.x) &gt; MOVE_SPEED:</div><div class=\"line\">\t\tmovement.x = sign(movement.x) * MOVE_SPEED</div><div class=\"line\">\t<span class=\"comment\">#Apply jumping</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> jump_input:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> !is_jump_pressed:</div><div class=\"line\">\t\t\tmovement.y = -JUMP_POWER</div><div class=\"line\">\t\tis_jump_pressed = true</div><div class=\"line\">\t<span class=\"keyword\">elif</span> !jump_input &amp;&amp; is_jump_pressed:</div><div class=\"line\">\t\tis_jump_pressed = false</div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\">\t<span class=\"comment\"># set the maximum falling speed</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.y &gt; MAX_FALLING_SPEED:</div><div class=\"line\">\t\tvelocity.y = MAX_FALLING_SPEED</div><div class=\"line\">\t<span class=\"comment\"># apply the movement by calling move(velocity) and store the remaining movement</span></div><div class=\"line\">\tvar remaining_movement = move(velocity)</div><div class=\"line\">\t<span class=\"comment\"># collision handling</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> is_colliding():</div><div class=\"line\">\t\tvar normal = get_collision_normal()</div><div class=\"line\">\t\tremaining_movement = normal.slide(remaining_movement)</div><div class=\"line\">\t\tvelocity = normal.slide(velocity)</div><div class=\"line\">\t\tmove(remaining_movement)</div></pre></td></tr></table></figure>\n<p>Now, the character must be jump correctly.</p>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/fixing_jump.gif\" alt=\"Character Jump\" title=\"Character Jump\">\n<h3 id=\"Restrict-the-Jump-only-when-grounded\"><a href=\"#Restrict-the-Jump-only-when-grounded\" class=\"headerlink\" title=\"Restrict the Jump, only when grounded\"></a>Restrict the Jump, only when grounded</h3><p>We have a problem, the character can jump anywhere and everywhere! We need to make the jump can only be done while on the ground, that was the idea. But the implementation is not that simple. I will start from the dirty way. Add a new variable named <code>var last_frame_grounded = false</code>. Then modify our code into like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> jump_input:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> !is_jump_pressed &amp;&amp; last_frame_grounded:</div><div class=\"line\">\t\t\tmovement.y = -JUMP_POWER</div><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> is_colliding():</div><div class=\"line\">\t\tvar normal = get_collision_normal()</div><div class=\"line\">\t\tremaining_movement = normal.slide(remaining_movement)</div><div class=\"line\">\t\tvelocity = normal.slide(velocity)</div><div class=\"line\">\t\tmove(remaining_movement)</div><div class=\"line\">\t\tlast_frame_grounded = true</div><div class=\"line\">\t<span class=\"keyword\">elif</span> last_frame_grounded:</div><div class=\"line\">\t\tlast_frame_grounded = false</div><div class=\"line\"><span class=\"comment\">#other code</span></div></pre></td></tr></table></figure>\n<p>But the problem with this implementation is when the character on the air and meet a wall, he can jumping. Because <code>is_colliding()</code> will return true whenever the character gets collision, in this case, wall/ceiling will be detected as collision too. Look at the image for the illustration</p>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/restrict_jump_on_ground_only_wall_allowed.gif\" alt=\"Jumping on Ground only, but wall detected as floor\" title=\"Jumping on Ground only, but wall detected as floor\">\n<p>So, to fix this, we need to determine our floor direction. Basically, floor direction is up which means <code>(0, -1)</code>. Modify our code into like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> is_colliding():</div><div class=\"line\">\t\tvar normal = get_collision_normal()</div><div class=\"line\">\t\tremaining_movement = normal.slide(remaining_movement)</div><div class=\"line\">\t\tvelocity = normal.slide(velocity)</div><div class=\"line\">\t\tmove(remaining_movement)</div><div class=\"line\">\t\t<span class=\"comment\"># if normal is floor, then set as grounded</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span> normal == Vector2(<span class=\"number\">0</span>, <span class=\"number\">-1</span>):</div><div class=\"line\">\t\t\tlast_frame_grounded = true</div><div class=\"line\"><span class=\"comment\">#other code</span></div></pre></td></tr></table></figure>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/restrict_jump_on_ground_only.gif\" alt=\"Jump Fixes\" title=\"Jump Fixes\">\n<p>Final code looks like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends KinematicBody2D</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># defines GRAVITY</span></div><div class=\"line\"><span class=\"comment\"># `export` makes your variable editable in the editor</span></div><div class=\"line\"><span class=\"comment\"># `var GRAVITY = 10` defines a variable named GRAVITY and assign it 10</span></div><div class=\"line\">export var GRAVITY = <span class=\"number\">10</span></div><div class=\"line\"><span class=\"comment\"># set the maximum falling speed per frame</span></div><div class=\"line\">export var MAX_FALLING_SPEED = <span class=\"number\">15</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># MOVE_SPEED</span></div><div class=\"line\">export var MOVE_SPEED = <span class=\"number\">5</span></div><div class=\"line\">export var MOVE_SPEED_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var move_step = <span class=\"number\">0</span></div><div class=\"line\">export var DECELERATION_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var dec_step = <span class=\"number\">0</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># jump power</span></div><div class=\"line\">export var JUMP_POWER = <span class=\"number\">5</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># store the player velocity</span></div><div class=\"line\">var velocity = Vector2()</div><div class=\"line\"><span class=\"comment\"># store status of jump input</span></div><div class=\"line\">var is_jump_pressed = false</div><div class=\"line\"><span class=\"comment\"># store status if last frame grounded</span></div><div class=\"line\">var last_frame_grounded = false</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called when the node is \"ready\", that means called when the game started.</span></div><div class=\"line\"><span class=\"comment\"># Use this function for initialize</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\tmove_step = MOVE_SPEED / MOVE_SPEED_TIME_NEEDED</div><div class=\"line\">\tdec_step = MOVE_SPEED / DECELERATION_TIME_NEEDED</div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called during the fixed processing step of the main loop.</span></div><div class=\"line\"><span class=\"comment\"># Fixed processing means that the frame rate is synced to the physics,</span></div><div class=\"line\"><span class=\"comment\"># i.e. the delta variable should be constant.</span></div><div class=\"line\"><span class=\"comment\"># only active when set_fixed_process(true) is called</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(velocity.x, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\">#input</span></div><div class=\"line\">\tvar right_input = Input.is_action_pressed(<span class=\"string\">\"right\"</span>)</div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\">\tvar jump_input = Input.is_action_pressed(<span class=\"string\">\"jump\"</span>)</div><div class=\"line\">\t<span class=\"comment\">#Apply the horizontal movement</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> right_input:</div><div class=\"line\">\t\tmovement.x += move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> left_input:</div><div class=\"line\">\t\tmovement.x -= move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> movement.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\t<span class=\"comment\">#get the direction of movement</span></div><div class=\"line\">\t\tvar _dir = sign(movement.x)</div><div class=\"line\">\t\t<span class=\"comment\">#calculate deceleration amount and direction</span></div><div class=\"line\">\t\tvar _dec = _dir * <span class=\"number\">-1</span> * dec_step * delta</div><div class=\"line\">\t\t<span class=\"comment\"># apply to movement</span></div><div class=\"line\">\t\tmovement.x += _dec</div><div class=\"line\">\t\t<span class=\"comment\"># stop it when reached 0</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span> _dir == <span class=\"number\">1</span> &amp;&amp; movement.x &lt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> _dir == <span class=\"number\">-1</span> &amp;&amp; movement.x &gt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t<span class=\"comment\">#if the movement.x more that max_speed, gap it</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(movement.x) &gt; MOVE_SPEED:</div><div class=\"line\">\t\tmovement.x = sign(movement.x) * MOVE_SPEED</div><div class=\"line\">\t<span class=\"comment\">#Apply jumping</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> jump_input:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> !is_jump_pressed &amp;&amp; last_frame_grounded:</div><div class=\"line\">\t\t\tmovement.y = -JUMP_POWER</div><div class=\"line\">\t\tis_jump_pressed = true</div><div class=\"line\">\t<span class=\"keyword\">elif</span> !jump_input &amp;&amp; is_jump_pressed:</div><div class=\"line\">\t\tis_jump_pressed = false</div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\">\t<span class=\"comment\"># set the maximum falling speed</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.y &gt; MAX_FALLING_SPEED:</div><div class=\"line\">\t\tvelocity.y = MAX_FALLING_SPEED</div><div class=\"line\">\t<span class=\"comment\"># apply the movement by calling move(velocity) and store the remaining movement</span></div><div class=\"line\">\tvar remaining_movement = move(velocity)</div><div class=\"line\">\t<span class=\"comment\"># collision handling</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> is_colliding():</div><div class=\"line\">\t\tvar normal = get_collision_normal()</div><div class=\"line\">\t\tremaining_movement = normal.slide(remaining_movement)</div><div class=\"line\">\t\tvelocity = normal.slide(velocity)</div><div class=\"line\">\t\tmove(remaining_movement)</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> normal == Vector2(<span class=\"number\">0</span>, <span class=\"number\">-1</span>):</div><div class=\"line\">\t\t\tlast_frame_grounded = true</div><div class=\"line\">\t<span class=\"keyword\">elif</span> last_frame_grounded:</div><div class=\"line\">\t\tlast_frame_grounded = false</div></pre></td></tr></table></figure>\n<div class=\"alert warning\"><p>This implementation only works with a game without slope ground, only flat ground which is the direction of the floor is (0, -1). You have been WARNED! I will make it more advance when Godot 3 release. So stay tuned on this website!</p>\n</div>\n<h3 id=\"Controlling-the-Jump-Height\"><a href=\"#Controlling-the-Jump-Height\" class=\"headerlink\" title=\"Controlling the Jump Height\"></a>Controlling the Jump Height</h3><p>The character jumps always at the same height. Most of the platformer game can control the jump height by how long user pressing the jump button. So let’s implement it by modify and add some code.</p>\n<p>First, change the <code>export var JUMP_POWER = 5</code> to <code>export var MAX_JUMP_POWER = 5</code></p>\n<p>Then add one more variable <code>export var MIN_JUMP_POWER = 2</code></p>\n<p>Now, we need to modify our implementation at jump method.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#prev code</span></div><div class=\"line\">\t<span class=\"comment\">#Apply jumping</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> jump_input:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> !is_jump_pressed &amp;&amp; last_frame_grounded:</div><div class=\"line\">\t\t\tmovement.y = -MAX_JUMP_POWER</div><div class=\"line\">\t\tis_jump_pressed = true</div><div class=\"line\">\t<span class=\"keyword\">elif</span> !jump_input &amp;&amp; is_jump_pressed:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> movement.y &lt; -MIN_JUMP_POWER:</div><div class=\"line\">\t\t\tmovement.y = -MIN_JUMP_POWER</div><div class=\"line\">\t\tis_jump_pressed = false</div><div class=\"line\"><span class=\"comment\">#next code</span></div></pre></td></tr></table></figure>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/controlling_jump_height.gif\" alt=\"Controlling Jump Height\" title=\"Controlling Jump Height\">\n<p>So the final code looks like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends KinematicBody2D</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># defines GRAVITY</span></div><div class=\"line\"><span class=\"comment\"># `export` makes your variable editable in the editor</span></div><div class=\"line\"><span class=\"comment\"># `var GRAVITY = 10` defines a variable named GRAVITY and assign it 10</span></div><div class=\"line\">export var GRAVITY = <span class=\"number\">10</span></div><div class=\"line\"><span class=\"comment\"># set the maximum falling speed per frame</span></div><div class=\"line\">export var MAX_FALLING_SPEED = <span class=\"number\">15</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># MOVE_SPEED</span></div><div class=\"line\">export var MOVE_SPEED = <span class=\"number\">5</span></div><div class=\"line\">export var MOVE_SPEED_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var move_step = <span class=\"number\">0</span></div><div class=\"line\">export var DECELERATION_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var dec_step = <span class=\"number\">0</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># jump power</span></div><div class=\"line\">export var MAX_JUMP_POWER = <span class=\"number\">5</span></div><div class=\"line\">export var MIN_JUMP_POWER = <span class=\"number\">2</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># store the player velocity</span></div><div class=\"line\">var velocity = Vector2()</div><div class=\"line\"><span class=\"comment\"># store status of jump input</span></div><div class=\"line\">var is_jump_pressed = false</div><div class=\"line\"><span class=\"comment\"># store status if last frame grounded</span></div><div class=\"line\">var last_frame_grounded = false</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called when the node is \"ready\", that means called when the game started.</span></div><div class=\"line\"><span class=\"comment\"># Use this function for initialize</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\tmove_step = MOVE_SPEED / MOVE_SPEED_TIME_NEEDED</div><div class=\"line\">\tdec_step = MOVE_SPEED / DECELERATION_TIME_NEEDED</div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called during the fixed processing step of the main loop.</span></div><div class=\"line\"><span class=\"comment\"># Fixed processing means that the frame rate is synced to the physics,</span></div><div class=\"line\"><span class=\"comment\"># i.e. the delta variable should be constant.</span></div><div class=\"line\"><span class=\"comment\"># only active when set_fixed_process(true) is called</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(velocity.x, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\">#input</span></div><div class=\"line\">\tvar right_input = Input.is_action_pressed(<span class=\"string\">\"right\"</span>)</div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\">\tvar jump_input = Input.is_action_pressed(<span class=\"string\">\"jump\"</span>)</div><div class=\"line\">\t<span class=\"comment\">#Apply the horizontal movement</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> right_input:</div><div class=\"line\">\t\tmovement.x += move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> left_input:</div><div class=\"line\">\t\tmovement.x -= move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> movement.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\t<span class=\"comment\">#get the direction of movement</span></div><div class=\"line\">\t\tvar _dir = sign(movement.x)</div><div class=\"line\">\t\t<span class=\"comment\">#calculate deceleration amount and direction</span></div><div class=\"line\">\t\tvar _dec = _dir * <span class=\"number\">-1</span> * dec_step * delta</div><div class=\"line\">\t\t<span class=\"comment\"># apply to movement</span></div><div class=\"line\">\t\tmovement.x += _dec</div><div class=\"line\">\t\t<span class=\"comment\"># stop it when reached 0</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span> _dir == <span class=\"number\">1</span> &amp;&amp; movement.x &lt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> _dir == <span class=\"number\">-1</span> &amp;&amp; movement.x &gt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t<span class=\"comment\">#if the movement.x more that max_speed, gap it</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(movement.x) &gt; MOVE_SPEED:</div><div class=\"line\">\t\tmovement.x = sign(movement.x) * MOVE_SPEED</div><div class=\"line\">\t<span class=\"comment\">#Apply jumping</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> jump_input:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> !is_jump_pressed &amp;&amp; last_frame_grounded:</div><div class=\"line\">\t\t\tmovement.y = -MAX_JUMP_POWER</div><div class=\"line\">\t\tis_jump_pressed = true</div><div class=\"line\">\t<span class=\"keyword\">elif</span> !jump_input &amp;&amp; is_jump_pressed:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> movement.y &lt; -MIN_JUMP_POWER:</div><div class=\"line\">\t\t\tmovement.y = -MIN_JUMP_POWER</div><div class=\"line\">\t\tis_jump_pressed = false</div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\">\t<span class=\"comment\"># set the maximum falling speed</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.y &gt; MAX_FALLING_SPEED:</div><div class=\"line\">\t\tvelocity.y = MAX_FALLING_SPEED</div><div class=\"line\">\t<span class=\"comment\"># apply the movement by calling move(velocity) and store the remaining movement</span></div><div class=\"line\">\tvar remaining_movement = move(velocity)</div><div class=\"line\">\t<span class=\"comment\"># collision handling</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> is_colliding():</div><div class=\"line\">\t\tvar normal = get_collision_normal()</div><div class=\"line\">\t\tremaining_movement = normal.slide(remaining_movement)</div><div class=\"line\">\t\tvelocity = normal.slide(velocity)</div><div class=\"line\">\t\tmove(remaining_movement)</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> normal == Vector2(<span class=\"number\">0</span>, <span class=\"number\">-1</span>):</div><div class=\"line\">\t\t\tlast_frame_grounded = true</div><div class=\"line\">\t<span class=\"keyword\">elif</span> last_frame_grounded:</div><div class=\"line\">\t\tlast_frame_grounded = false</div></pre></td></tr></table></figure>\n<p>When user presses the jump button, movement.y directly set as MAX_JUMP_POWER. But, when user releases the jump button and the movement.y is still more than MAX_JUMP_POWER, then set movement.y into MIN_JUMP_POWER, don’t set it to 0, because the result will be weird. Try it yourself if you don’t trust me, hehe.</p>\n<h3 id=\"Multiple-Jump\"><a href=\"#Multiple-Jump\" class=\"headerlink\" title=\"Multiple Jump\"></a>Multiple Jump</h3><p>The idea is, the character can jump while in the air, but not infinite jump. Add 2 new variable, one for how many jumps can be done in the air, and the other is for counting how many jumps in the air has been done. If the counter has reached the maximum jump air can be done, the character can’t jump again. So let’s get started. Add 2 variable, <code>export var MAX_AIR_JUMP_COUNT = 2</code> and <code>var air_jump_count = 0</code>. Then modify our code into like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">\t<span class=\"comment\">#Apply jumping</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> jump_input:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> !is_jump_pressed &amp;&amp; last_frame_grounded:</div><div class=\"line\">\t\t\tmovement.y = -MAX_JUMP_POWER</div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> !is_jump_pressed &amp;&amp; !last_frame_grounded &amp;&amp; air_jump_count &lt; MAX_AIR_JUMP_COUNT:</div><div class=\"line\">\t\t\tmovement.y = -MAX_JUMP_POWER</div><div class=\"line\">\t\t\tair_jump_count += <span class=\"number\">1</span></div><div class=\"line\">\t\tis_jump_pressed = true</div><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> is_colliding():</div><div class=\"line\">\t\t<span class=\"comment\">#other code</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span> normal == Vector2(<span class=\"number\">0</span>, <span class=\"number\">-1</span>):</div><div class=\"line\">\t\t\tlast_frame_grounded = true</div><div class=\"line\">\t\t\tair_jump_count = <span class=\"number\">0</span></div><div class=\"line\"><span class=\"comment\">#other code</span></div></pre></td></tr></table></figure>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/multiple_jump.gif\" alt=\"Multiple Jump\" title=\"Multiple Jump\">\n<p>I want to make the air jump is not as same height as the ground jump. So I will add 2 new variable for defines the air jump power, one for the max jump power and the other is for min jump power. Let’s add 2 new variable <code>export var MAX_AIR_JUMP_POWER = 3</code> and <code>export var MIN_AIR_JUMP_POWER = 1.5</code>. Then modify our code into like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\"><span class=\"comment\">#other code</span></div><div class=\"line\">\t<span class=\"comment\">#Apply jumping</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> jump_input:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> !is_jump_pressed &amp;&amp; last_frame_grounded:</div><div class=\"line\">\t\t\tmovement.y = -MAX_JUMP_POWER</div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> !is_jump_pressed &amp;&amp; !last_frame_grounded &amp;&amp; air_jump_count &lt; MAX_AIR_JUMP_COUNT:</div><div class=\"line\">\t\t\tmovement.y = -MAX_AIR_JUMP_POWER</div><div class=\"line\">\t\t\tair_jump_count += <span class=\"number\">1</span></div><div class=\"line\">\t\tis_jump_pressed = true</div><div class=\"line\">\t<span class=\"keyword\">elif</span> !jump_input &amp;&amp; is_jump_pressed:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> air_jump_count != <span class=\"number\">0</span> &amp;&amp; movement.y &lt; -MIN_AIR_JUMP_POWER:</div><div class=\"line\">\t\t\tmovement.y = -MIN_AIR_JUMP_POWER</div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> movement.y &lt; -MIN_JUMP_POWER:</div><div class=\"line\">\t\t\tmovement.y = -MIN_JUMP_POWER</div><div class=\"line\">\t\tis_jump_pressed = false</div><div class=\"line\"><span class=\"comment\">#other code</span></div></pre></td></tr></table></figure>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/multiple_jump_2.gif\" alt=\"Multiple Jump\" title=\"Multiple Jump\">\n<p>The final code will look like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends KinematicBody2D</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># defines GRAVITY</span></div><div class=\"line\"><span class=\"comment\"># `export` makes your variable editable in the editor</span></div><div class=\"line\"><span class=\"comment\"># `var GRAVITY = 10` defines a variable named GRAVITY and assign it 10</span></div><div class=\"line\"></div><div class=\"line\">export var GRAVITY = <span class=\"number\">10</span></div><div class=\"line\"><span class=\"comment\"># set the maximum falling speed per frame</span></div><div class=\"line\">export var MAX_FALLING_SPEED = <span class=\"number\">15</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># MOVE_SPEED</span></div><div class=\"line\">export var MOVE_SPEED = <span class=\"number\">5</span></div><div class=\"line\">export var MOVE_SPEED_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var move_step = <span class=\"number\">0</span></div><div class=\"line\">export var DECELERATION_TIME_NEEDED = <span class=\"number\">.15</span></div><div class=\"line\">var dec_step = <span class=\"number\">0</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># jump power</span></div><div class=\"line\">export var MAX_JUMP_POWER = <span class=\"number\">5</span></div><div class=\"line\">export var MIN_JUMP_POWER = <span class=\"number\">2</span></div><div class=\"line\">export var MAX_AIR_JUMP_POWER = <span class=\"number\">3</span></div><div class=\"line\">export var MIN_AIR_JUMP_POWER = <span class=\"number\">1.5</span></div><div class=\"line\">export var MAX_AIR_JUMP_COUNT = <span class=\"number\">2</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># store the player velocity</span></div><div class=\"line\">var velocity = Vector2()</div><div class=\"line\"><span class=\"comment\"># store status of jump input</span></div><div class=\"line\">var is_jump_pressed = false</div><div class=\"line\"><span class=\"comment\"># store status if last frame grounded</span></div><div class=\"line\">var last_frame_grounded = false</div><div class=\"line\"><span class=\"comment\">#store jump counter</span></div><div class=\"line\">var air_jump_count = <span class=\"number\">0</span></div><div class=\"line\"><span class=\"comment\"># Called when the node is \"ready\", that means called when the game started.</span></div><div class=\"line\"><span class=\"comment\"># Use this function for initialize</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\tmove_step = MOVE_SPEED / MOVE_SPEED_TIME_NEEDED</div><div class=\"line\">\tdec_step = MOVE_SPEED / DECELERATION_TIME_NEEDED</div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"><span class=\"comment\"># Called during the fixed processing step of the main loop.</span></div><div class=\"line\"><span class=\"comment\"># Fixed processing means that the frame rate is synced to the physics,</span></div><div class=\"line\"><span class=\"comment\"># i.e. the delta variable should be constant.</span></div><div class=\"line\"><span class=\"comment\"># only active when set_fixed_process(true) is called</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(velocity.x, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\">#input</span></div><div class=\"line\">\tvar right_input = Input.is_action_pressed(<span class=\"string\">\"right\"</span>)</div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\">\tvar jump_input = Input.is_action_pressed(<span class=\"string\">\"jump\"</span>)</div><div class=\"line\">\t<span class=\"comment\">#Apply the horizontal movement</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> right_input:</div><div class=\"line\">\t\tmovement.x += move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> left_input:</div><div class=\"line\">\t\tmovement.x -= move_step * delta</div><div class=\"line\">\t<span class=\"keyword\">elif</span> movement.x != <span class=\"number\">0</span>:</div><div class=\"line\">\t\t<span class=\"comment\">#get the direction of movement</span></div><div class=\"line\">\t\tvar _dir = sign(movement.x)</div><div class=\"line\">\t\t<span class=\"comment\">#calculate deceleration amount and direction</span></div><div class=\"line\">\t\tvar _dec = _dir * <span class=\"number\">-1</span> * dec_step * delta</div><div class=\"line\">\t\t<span class=\"comment\"># apply to movement</span></div><div class=\"line\">\t\tmovement.x += _dec</div><div class=\"line\">\t\t<span class=\"comment\"># stop it when reached 0</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span> _dir == <span class=\"number\">1</span> &amp;&amp; movement.x &lt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> _dir == <span class=\"number\">-1</span> &amp;&amp; movement.x &gt; <span class=\"number\">0</span>:</div><div class=\"line\">\t\t\tmovement.x = <span class=\"number\">0</span></div><div class=\"line\">\t<span class=\"comment\">#if the movement.x more that max_speed, gap it</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> abs(movement.x) &gt; MOVE_SPEED:</div><div class=\"line\">\t\tmovement.x = sign(movement.x) * MOVE_SPEED</div><div class=\"line\">\t<span class=\"comment\">#Apply jumping</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> jump_input:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> !is_jump_pressed &amp;&amp; last_frame_grounded:</div><div class=\"line\">\t\t\tmovement.y = -MAX_JUMP_POWER</div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> !is_jump_pressed &amp;&amp; !last_frame_grounded &amp;&amp; air_jump_count &lt; MAX_AIR_JUMP_COUNT:</div><div class=\"line\">\t\t\tmovement.y = -MAX_AIR_JUMP_POWER</div><div class=\"line\">\t\t\tair_jump_count += <span class=\"number\">1</span></div><div class=\"line\">\t\tis_jump_pressed = true</div><div class=\"line\">\t<span class=\"keyword\">elif</span> !jump_input &amp;&amp; is_jump_pressed:</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> air_jump_count != <span class=\"number\">0</span> &amp;&amp; movement.y &lt; -MIN_AIR_JUMP_POWER:</div><div class=\"line\">\t\t\tmovement.y = -MIN_AIR_JUMP_POWER</div><div class=\"line\">\t\t<span class=\"keyword\">elif</span> movement.y &lt; -MIN_JUMP_POWER:</div><div class=\"line\">\t\t\tmovement.y = -MIN_JUMP_POWER</div><div class=\"line\">\t\tis_jump_pressed = false</div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\">\t<span class=\"comment\"># set the maximum falling speed</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.y &gt; MAX_FALLING_SPEED:</div><div class=\"line\">\t\tvelocity.y = MAX_FALLING_SPEED</div><div class=\"line\">\t<span class=\"comment\"># apply the movement by calling move(velocity) and store the remaining movement</span></div><div class=\"line\">\tvar remaining_movement = move(velocity)</div><div class=\"line\">\t<span class=\"comment\"># collision handling</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> is_colliding():</div><div class=\"line\">\t\tvar normal = get_collision_normal()</div><div class=\"line\">\t\tremaining_movement = normal.slide(remaining_movement)</div><div class=\"line\">\t\tvelocity = normal.slide(velocity)</div><div class=\"line\">\t\tmove(remaining_movement)</div><div class=\"line\">\t\t<span class=\"comment\"># if normal is floor, then set as grounded</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span> normal == Vector2(<span class=\"number\">0</span>, <span class=\"number\">-1</span>):</div><div class=\"line\">\t\t\tlast_frame_grounded = true</div><div class=\"line\">\t\t\tair_jump_count = <span class=\"number\">0</span></div><div class=\"line\">\t<span class=\"keyword\">elif</span> last_frame_grounded:</div><div class=\"line\">\t\tlast_frame_grounded = false</div></pre></td></tr></table></figure>\n<h2 id=\"Fixing-Jitter-Movement\"><a href=\"#Fixing-Jitter-Movement\" class=\"headerlink\" title=\"Fixing Jitter Movement\"></a>Fixing Jitter Movement</h2><p>Okay lately, I just figured out after making some gif image, the character always jiggling! However this is not noticeable for now, but in the future, this will be worse! Making sure that was really jitter movement, or maybe just my gif image quality? So, I record my screen and play it in slow motion, and ahaaaa, I’ve noticed it, jitter movement happened.</p>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/jiggly.gif\" alt=\"Jitter Movement\" title=\"Jitter Movement\">\n<div class=\"alert warning\"><p>To be honest, this glitch is hard to notice. However, I’m trying to reproduce this jitter movement and really hard to notice the jitter movement.</p>\n</div>\n<p>What we only need to do is activate the <strong>motion_fix_enabled</strong> in <strong>Project Settings - Physics 2D</strong>. This will handle jitter movement</p>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/motion_fix_enable.jpg\" alt=\"Motion Fix Enabled\" title=\"Motion Fix Enabled\">\n<p>This is the preview when I using old implementation and the new one</p>\n<p><strong>BEFORE</strong></p>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/jiggly2.gif\" alt=\"Jitter Movement\" title=\"Jitter Movement\">\n<p><strong>AFTER</strong></p>\n<img src=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/normal.gif\" alt=\"Fix Movement\" title=\"Fix Movement\">\n<p>Okay that was all for today, next tutorial will be <a href=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/\" title=\"Tilemap and Camera\">Tilemap and Camera</a>, see ya in the next tutorial.</p>\n<p><a href=\"https://github.com/damarindra/2D-Platformer-Godot\" target=\"_blank\" rel=\"external\">Download Project Here</a></p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>","categories":["godot","tutorial","tutorial_platformer"],"tags":["Godot","gamedev","game","development","platformer"]},{"title":"Player Creation - Platformer Tutorial Part 2 - Godot","url":"http://damarindra.com/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/","content":"<div class=\"spoiler collapsed\"><div class=\"spoiler-title\">Table of Content</div><div class=\"spoiler-content\"><!-- toc --></div></div>\n<p>This is the second part of the tutorial creating platformer game on Godot Engine. In this tutorial, I will explain how to make player, from the basic node creation until moving. So let’s get started!</p>\n<a id=\"more\"></a>\n<ol>\n<li><a href=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/\" title=\"Part 1 : Preparation\">Part 1 : Preparation</a></li>\n<li><strong>Part 2 : Player Creation</strong></li>\n<li><a href=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/\" title=\"Part 3 : Player Creation 2\">Part 3 : Player Creation 2</a></li>\n<li><a href=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/\" title=\"Part 4 : Tilemap and Camera\">Part 4 : Tilemap and Camera</a></li>\n<li><a href=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/\" title=\"Part 5 : Player Animation\">Part 5 : Player Animation</a></li>\n<li><a href=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/\" title=\"Part 6 : Parallax Background and Level Bounds\">Part 6 : Parallax Background and Level Bounds</a>\n</li>\n</ol>\n<h1 id=\"Prepare-the-Node\"><a href=\"#Prepare-the-Node\" class=\"headerlink\" title=\"Prepare the Node\"></a>Prepare the Node</h1><p>Okay, now we will create a Player. First of all, create a new scene by clicking the <strong>Scene Menu</strong> at the top left toolbar, then select the <strong>New Scene</strong>. Now, new tab named as <strong>[empty]</strong> in the Scene View appears.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/create_scene.gif\" alt=\"Create Scene\" title=\"Create Scene\">\n<h2 id=\"Create-KinematicBody2D\"><a href=\"#Create-KinematicBody2D\" class=\"headerlink\" title=\"Create KinematicBody2D\"></a>Create KinematicBody2D</h2><p>Now go into <strong>Scene Window</strong>, create a new <strong>KinematicBody2D</strong> node, by clicking <strong>‘+’</strong> button and search KinematicBody2D, then  double click it or click create button. <strong>Rename</strong> the KinematicBody2D to “Player”.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/create_player.gif\" alt=\"Create KinematicBody2D\" title=\"Create KinematicBody2D\">\n<h2 id=\"Create-Sprite\"><a href=\"#Create-Sprite\" class=\"headerlink\" title=\"Create Sprite\"></a>Create Sprite</h2><p>Make sure Player Node has been selected, then create a <strong>Sprite</strong> Node by clicking the ‘+’ button, search Sprite and create it.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/create_sprite.gif\" alt=\"Create Sprite\" title=\"Create Sprite\">\n<p>Now we need to <strong>assign</strong> the sprite image, select the Sprite Node, go to the Inspector Window, navigate into the <strong>Texture</strong>, click the <strong><null> button</null></strong>, select <strong>Load</strong>. The new window will show up, select the <strong>tiles.png</strong>.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/manage_sprite.gif\" alt=\"Manage Sprite\" title=\"Manage Sprite\">\n<p>Sprite in Godot support for the tileset, so as you can see our image is a bunch of sprites with each tile size is 16px (for the character the size is 32px). Because our image size is 320px x 352px, so we need to set the <em> <strong>VFrames</strong> </em> 10 (320 / 32 = 10) and <em> <strong>HFrames</strong> </em> 11 (352 / 32 = 11). Divided by 32 because the character size is 32px x 32px.</p>\n<p>Now <strong>save</strong> the Node by press Ctrl + S, save as Player.tscn. Now try to change the <strong>Frame</strong> by clicking the up and down button on the right side.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/frame.jpg\" alt=\"Sprite Frame\" title=\"Sprite Frame\">\n<p>Doesn’t change anything?? Don’t panic, sometimes that happened. Make sure you have saved the Node, then close the Player Scene by clicking ‘x’ button at the tab Player, open again the Player.tscn from the FileSystem Window. Now try to change the Frame Value, now must be fixed.</p>\n<h2 id=\"Create-CollisionShape2D\"><a href=\"#Create-CollisionShape2D\" class=\"headerlink\" title=\"Create CollisionShape2D\"></a>Create CollisionShape2D</h2><p>Next, create a new node by <strong>right click</strong> the Player Node, select <strong>Add Child Node</strong>, find the <strong>CollisionShape2D</strong>, and create it.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/create_collision_node.gif\" alt=\"Create CollisionShape2D\" title=\"Create CollisionShape2D\">\n<p>Select the CollisionShape2D and go to the Inspector View, navigate to <strong>Shape</strong>, click the <null> button, select <strong>New RectangleShape2D</strong>. Now you can setup the collision size directly from the Scene View.</null></p>\n<div class=\"alert info\"><p><strong>PRO TIPS</strong> : You can edit collision shape into precise value by activating the Snap Option. Click <em>Edit - Use Snap</em>, setup the snap value by clicking <em>Edit - Configure Snap</em>.</p>\n</div>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/create_collision_shape.gif\" alt=\"Create CollisionShape2D Shape\" title=\"Create CollisionShape2D Shape\">\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/collision_shape.jpg\" alt=\"CollisionShape2D Shape\" title=\"CollisionShape2D Shape\">\n<p>That was only the preparation, now the real challenge just BEGIN!!</p>\n<h1 id=\"Ready-to-become-a-Wizard\"><a href=\"#Ready-to-become-a-Wizard\" class=\"headerlink\" title=\"Ready to become a Wizard?\"></a>Ready to become a Wizard?</h1><p>Script is like a human brain. Without a script, node can’t make a decision what should they do. In Godot, we use GDScript for the scripting language. C# support will be available in the future. GDScript is easy to learn, so don’t let yourself down now, at least try it a bit. You don’t know until you try, right? I bet when Godot V3 released, you will love scripting with GDScript inside Godot Editor, much improvement, I’ve been tried it!! If you don’t know anything about GDScript, I recommend to learn from <a href=\"http://docs.godotengine.org/en/stable/learning/scripting/gdscript/index.html\" target=\"_blank\" rel=\"external\">here</a>!!!</p>\n<p>So, back to the topic! Select Player node, see in the inspector, scroll into deep down, you will found <strong>Script</strong>, click the <null> button, select <strong>New Script</strong>. A new window will appear, for me, I just click the create button since I don’t want to change anything here. The 2D view will automatically switch to script view.</null></p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/create_script.gif\" alt=\"Create Script\" title=\"Create Script\">\n<p>Now we need to write some code, follow my script from now, read the code for the explanation.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends KinematicBody2D</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># defines GRAVITY</span></div><div class=\"line\"><span class=\"comment\"># `export` makes your variable editable in the editor</span></div><div class=\"line\"><span class=\"comment\"># `var GRAVITY = 10` defines a variable named GRAVITY and assign it 10</span></div><div class=\"line\">export var GRAVITY = <span class=\"number\">10</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called when the node is \"ready\", that means called when the game started.</span></div><div class=\"line\"><span class=\"comment\"># Use this function for initialize</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\t<span class=\"comment\"># makes `_fixed_process(delta)` running</span></div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called during the fixed processing step of the main loop.</span></div><div class=\"line\"><span class=\"comment\"># Fixed processing means that the frame rate is synced to the physics,</span></div><div class=\"line\"><span class=\"comment\"># i.e. the delta variable should be constant.</span></div><div class=\"line\"><span class=\"comment\"># only active when set_fixed_process(true) is called</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(<span class=\"number\">0</span>,GRAVITY)</div><div class=\"line\">\t<span class=\"comment\"># apply the movement by calling move(movement*delta)</span></div><div class=\"line\">\tmove(movement*delta)</div></pre></td></tr></table></figure>\n<p>Press F6 to test it. Make sure the result is same as mine, the character will fall down. If your character just stays, or different as mine, there must be something wrong.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/result.gif\" alt=\"Result\" title=\"Result\">\n<p>If you come from Unity, you must be wondering about GRAVITY. The Gravity value is positive, means the character must go up, not down. Yes, I once thought that way, but in Godot 2D, the vector y is opposite, so the down direction is positive and up direction is negative, got it?</p>\n<h2 id=\"Create-the-Test-Scene\"><a href=\"#Create-the-Test-Scene\" class=\"headerlink\" title=\"Create the Test Scene\"></a>Create the Test Scene</h2><p>Create a new scene and add Node2D. After that, add <strong>StaticBody2D</strong> as a child of Node2D. Then add CollisionShape2D as a child of StaticBody2D. StaticBody2D is container for <em>non-moveable</em> CollisionShape2D (ex: ground), <a href=\"http://docs.godotengine.org/en/stable/learning/features/physics/physics_introduction.html\" target=\"_blank\" rel=\"external\">more about physics</a>. Now Create the new RectangleShape2D of the CollisionShape2D, resize and move it. <strong>Save</strong> it as World.tscn.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/setup_world.gif\" alt=\"Create World\" title=\"Create World\">\n<p>Now add a new <strong>Camera2D</strong> node as a child of Node2D. Set the Zoom into (0.25, 0.25) and activate the Current option. Camera2D is a projection for 2D scenes, if we don’t use camera, the projection is always set from the (0,0) until the size of the viewport (found at project settings).</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/create_camera.gif\" alt=\"Create Camera2D\" title=\"Create Camera2D\">\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/camera_inspector.jpg\" alt=\"Camera Inspector\" title=\"Camera Inspector\">\n<p>Drag and drop <strong>player.tscn</strong> from the FileSystem window into <strong>Node2D</strong> at the Scene Window.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/assign_player.gif\" alt=\"Assign Player into Scene\" title=\"Assign Player into Scene\">\n<p>Don’t forget to set active the <strong>Visible Collision Shape</strong> from the <strong>Debug menu</strong> (inside of the play menu center top, right corner is the Debug Menu). When the option is set as ON, the collision will visible while play mode.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/visible_collision_shape.jpg\" alt=\"Visible Collision Shape\" title=\"Visible Collision Shape\">\n<p>Play it (press F6)</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/test_play.gif\" alt=\"Test Play\" title=\"Test Play\">\n<h3 id=\"Fixing-the-gravity\"><a href=\"#Fixing-the-gravity\" class=\"headerlink\" title=\"Fixing the gravity\"></a>Fixing the gravity</h3><p>When an object falling down because of gravity, the speed will increase incrementally. To do this, add one more variable to store our velocity</p>\n<p><code>var velocity = Vector2()</code></p>\n<p>And change the old code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">var movement = Vector2(<span class=\"number\">0</span>,GRAVITY)</div><div class=\"line\">move(movement*delta)</div></pre></td></tr></table></figure>\n<p>with this one</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">var movement = Vector2(<span class=\"number\">0</span>, velocity.y + GRAVITY * delta)</div><div class=\"line\">velocity = movement</div><div class=\"line\">move(velocity)</div></pre></td></tr></table></figure>\n<p>So the final code will look like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends KinematicBody2D</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># defines GRAVITY</span></div><div class=\"line\"><span class=\"comment\"># `export` makes your variable editable in the editor</span></div><div class=\"line\"><span class=\"comment\"># `var GRAVITY = 10` defines a variable named GRAVITY and assign it 10</span></div><div class=\"line\">export var GRAVITY = <span class=\"number\">10</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># store the player velocity</span></div><div class=\"line\">var velocity = Vector2()</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called when the node is \"ready\", that means called when the game started.</span></div><div class=\"line\"><span class=\"comment\"># Use this function for initialize</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\t<span class=\"comment\"># makes `_fixed_process(delta)` running</span></div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called during the fixed processing step of the main loop.</span></div><div class=\"line\"><span class=\"comment\"># Fixed processing means that the frame rate is synced to the physics,</span></div><div class=\"line\"><span class=\"comment\"># i.e. the delta variable should be constant.</span></div><div class=\"line\"><span class=\"comment\"># only active when set_fixed_process(true) is called</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(<span class=\"number\">0</span>, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\">    \t<span class=\"comment\"># apply the movement by calling move(velocity)</span></div><div class=\"line\">    \tmove(velocity)</div></pre></td></tr></table></figure>\n<div class=\"alert info\"><p>KEEP IN MIND! The concept of gravity is per second, so the character will falling down by 10px per second (incrementally), not per frame. This is why we multiply the GRAVITY by delta. Multiply a number by delta will make anything into per second.</p>\n</div>\n<p>You can try to play it, press F6, the gravity will look good now, the fall speed will increase each frame, not constant like before.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/gravity_fix.gif\" alt=\"Gravity Fix\" title=\"Gravity Fix\">\n<h3 id=\"Set-Maximum-Falling-speed\"><a href=\"#Set-Maximum-Falling-speed\" class=\"headerlink\" title=\"Set Maximum Falling speed\"></a>Set Maximum Falling speed</h3><p>When the character falling down from high ground, the falling speed always increases by gravity and make the character falling really fast. So we need to make the falling speed not more than max falling speed. Create a new variable <code>MAX_FALLING_SPEED</code>, and follow this code</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">//another code</div><div class=\"line\">export var GRAVITY = <span class=\"number\">10</span></div><div class=\"line\"><span class=\"comment\"># set the maximum falling speed per frame</span></div><div class=\"line\">export var MAX_FALLING_SPEED = <span class=\"number\">15</span></div><div class=\"line\"></div><div class=\"line\">//another code</div><div class=\"line\"></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(<span class=\"number\">0</span>, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\">\t<span class=\"comment\"># set the maximum falling speed</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.y &gt; MAX_FALLING_SPEED:</div><div class=\"line\">\t\tvelocity.y = MAX_FALLING_SPEED</div><div class=\"line\">\t<span class=\"comment\"># apply the movement by calling move(velocity)</span></div><div class=\"line\">    \tmove(velocity)</div><div class=\"line\"></div><div class=\"line\">//another code</div></pre></td></tr></table></figure>\n<p>So when the <code>velocity.y</code> reached the <code>MAX_FALLING_SPEED</code>, then set the <code>velocity.y</code> to <code>MAX_FALLING_SPEED</code>.</p>\n<div class=\"spoiler collapsed\"><div class=\"spoiler-title\">Gravity Conclusion</div><div class=\"spoiler-content\"><p><img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/gravity.gif\" alt=\"Gravity Resume\" title=\"Gravity Resume\"></p>\n</div></div>\n<h2 id=\"Make-the-player-moving\"><a href=\"#Make-the-player-moving\" class=\"headerlink\" title=\"Make the player moving\"></a>Make the player moving</h2><h3 id=\"Setup-the-Input-Map\"><a href=\"#Setup-the-Input-Map\" class=\"headerlink\" title=\"Setup the Input Map\"></a>Setup the Input Map</h3><p>We need to setup our <strong>Input Map</strong> to define what button we use in the game. For now, I need to define 5 buttons, <em>right, left, up, down, jump</em>. To do this, click <em>Scene - Project Settings - Input Map</em>, add new Action, just write the action name, for example, ‘right’, then click Add button. <strong>Re-do</strong> this until you have right, left, up, down, jump action. Then, scroll down and navigate your action. Select one of your action, for example, ‘right’ action. Then on the <strong>right side</strong>, you can find <strong>‘+’</strong> button, click it and select Key, now <strong>press ‘D’ key</strong> and click OK button. So, we have bound our right action with ‘D’ key. Re-do this step until our all action bound with a key.</p>\n<ul>\n<li>right : D</li>\n<li>left : A</li>\n<li>up : W</li>\n<li>down : S</li>\n<li>jump : Space</li>\n</ul>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/setup_input.gif\" alt=\"Setup Input Map\" title=\"Setup Input Map\">\n<h3 id=\"Horizontal-Movement\"><a href=\"#Horizontal-Movement\" class=\"headerlink\" title=\"Horizontal Movement\"></a>Horizontal Movement</h3><p>Now implement the horizontal movement. First of all, we need to add our Input variable.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(<span class=\"number\">0</span>, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\">#input</span></div><div class=\"line\">\tvar right_input = Input.is_action_pressed(<span class=\"string\">\"right\"</span>)</div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\"><span class=\"comment\"># Some other code</span></div></pre></td></tr></table></figure>\n<p><code>Input.is_action_pressed(&quot;right&quot;)</code>, the parameter get from the Input Map Action name, If you still remember, we’ve been setup 5 input map right?</p>\n<p>Next one, we need to apply our movement velocity. First of all, we need to define the move speed, add one variable with export prefix, so we can edit while in the editor.</p>\n<p><code>export var MOVE_SPEED = 5</code></p>\n<p>Then, we create the movement logic.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">.....</div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\">\t<span class=\"comment\">#Apply the horizontal movement</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> right_input:</div><div class=\"line\">\t\tmovement.x = MOVE_SPEED</div><div class=\"line\">\t<span class=\"keyword\">elif</span> left_input:</div><div class=\"line\">\t\tmovement.x = -MOVE_SPEED</div><div class=\"line\">.....</div></pre></td></tr></table></figure>\n<p>So, if the right action is pressed, set the x axis of movement into = MOVE_SPEED, if the left action is pressed, then set the x axis of movement into = -MOVE_SPEED. Remember, the right direction is positive, left direction is negative.</p>\n<p>The final code looks like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends KinematicBody2D</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># defines GRAVITY</span></div><div class=\"line\"><span class=\"comment\"># `export` makes your variable editable in the editor</span></div><div class=\"line\"><span class=\"comment\"># `var GRAVITY = 10` defines a variable named GRAVITY and assign it 10</span></div><div class=\"line\">export var GRAVITY = <span class=\"number\">10</span></div><div class=\"line\"><span class=\"comment\"># set the maximum falling speed per frame</span></div><div class=\"line\">export var MAX_FALLING_SPEED = <span class=\"number\">15</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># MOVE_SPEED</span></div><div class=\"line\">export var MOVE_SPEED = <span class=\"number\">5</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># store the player velocity</span></div><div class=\"line\">var velocity = Vector2()</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called when the node is \"ready\", that means called when the game started.</span></div><div class=\"line\"><span class=\"comment\"># Use this function for initialize</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\t<span class=\"comment\"># makes `_fixed_process(delta)` running</span></div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called during the fixed processing step of the main loop.</span></div><div class=\"line\"><span class=\"comment\"># Fixed processing means that the frame rate is synced to the physics,</span></div><div class=\"line\"><span class=\"comment\"># i.e. the delta variable should be constant.</span></div><div class=\"line\"><span class=\"comment\"># only active when set_fixed_process(true) is called</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(<span class=\"number\">0</span>, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\">#input</span></div><div class=\"line\">\tvar right_input = Input.is_action_pressed(<span class=\"string\">\"right\"</span>)</div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\">\t<span class=\"comment\">#Apply the horizontal movement</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> right_input:</div><div class=\"line\">\t\tmovement.x = MOVE_SPEED</div><div class=\"line\">\t<span class=\"keyword\">elif</span> left_input:</div><div class=\"line\">\t\tmovement.x = -MOVE_SPEED</div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\">\t<span class=\"comment\"># set the maximum falling speed</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.y &gt; MAX_FALLING_SPEED:</div><div class=\"line\">\t\tvelocity.y = MAX_FALLING_SPEED</div><div class=\"line\">\t<span class=\"comment\"># apply the movement by calling move(velocity)</span></div><div class=\"line\">\tmove(velocity)</div></pre></td></tr></table></figure>\n<p>Try to play and press the ‘D’ or ‘A’ key.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/hor_move.gif\" alt=\"Horizontal Movement\" title=\"Horizontal Movement\">\n<h3 id=\"Fixing-the-Horizontal-Movement\"><a href=\"#Fixing-the-Horizontal-Movement\" class=\"headerlink\" title=\"Fixing the Horizontal Movement\"></a>Fixing the Horizontal Movement</h3><p>Did you notice it? While on the air, the movement is fast, and while on the ground, the movement is really slow. Before into that, see the explanation about how the character can moving.</p>\n<div class=\"alert info\"><p>Velocity number is just abstract number, not the real number. Used for explain where the character move!!</p>\n</div>\n<p><br></p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/exp.jpg\" alt=\"Explanation about Movement\" title=\"Explanation about Movement\">\n<p>Got it? now this is the explanation why the character really slow while on the ground</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/exp2.gif\" alt=\"Explanation about slow movement\" title=\"Explanation about slow movement\">\n<p>Understand? So the velocity.y is always pushing down, and the result of func move always stopped at where the collision detected, that’s the problem. So how we fix this? See the picture below.</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/exp3.gif\" alt=\"Explanation about fixing the movement\" title=\"Explanation about fixing the movement\">\n<p>There are so many ways to fix this, but I recommend this one. We can use slide function to fix this, it can handle all collision direction. Formula behind slide function is</p>\n<p><code>V1.slide(V2) = V2 - V1 * scalar(V1, V2)</code> Scalar is same as dot product, read <a href=\"http://docs.godotengine.org/en/stable/learning/features/math/vector_math.html\" target=\"_blank\" rel=\"external\">here</a> for more explanation.</p>\n<p>Now, implement the code! follow my lead!!</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">....</div><div class=\"line\">\t<span class=\"comment\"># set the maximum falling speed</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.y &gt; MAX_FALLING_SPEED:</div><div class=\"line\">\t\tvelocity.y = MAX_FALLING_SPEED</div><div class=\"line\">    \t<span class=\"comment\"># apply the movement by calling move(velocity) and store the remaining movement</span></div><div class=\"line\">    \tvar remaining_movement = move(velocity)</div><div class=\"line\">    \t<span class=\"comment\"># collision handling</span></div><div class=\"line\">    \t<span class=\"keyword\">if</span> is_colliding():</div><div class=\"line\">        \tvar normal = get_collision_normal()</div><div class=\"line\">        \tremaining_movement = normal.slide(remaining_movement)</div><div class=\"line\">        \tvelocity = normal.slide(velocity)</div><div class=\"line\">        \tmove(remaining_movement)</div></pre></td></tr></table></figure>\n<p>The final code looks like this</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div></pre></td><td class=\"code\"><pre><div class=\"line\">extends KinematicBody2D</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># defines GRAVITY</span></div><div class=\"line\"><span class=\"comment\"># `export` makes your variable editable in the editor</span></div><div class=\"line\"><span class=\"comment\"># `var GRAVITY = 10` defines a variable named GRAVITY and assign it 10</span></div><div class=\"line\">export var GRAVITY = <span class=\"number\">10</span></div><div class=\"line\"><span class=\"comment\"># set the maximum falling speed per frame</span></div><div class=\"line\">export var MAX_FALLING_SPEED = <span class=\"number\">15</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># MOVE_SPEED</span></div><div class=\"line\">export var MOVE_SPEED = <span class=\"number\">5</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># store the player velocity</span></div><div class=\"line\">var velocity = Vector2()</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called when the node is \"ready\", that means called when the game started.</span></div><div class=\"line\"><span class=\"comment\"># Use this function for initialize</span></div><div class=\"line\">func _ready():</div><div class=\"line\">\t<span class=\"comment\"># makes `_fixed_process(delta)` running</span></div><div class=\"line\">\tset_fixed_process(true)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Called during the fixed processing step of the main loop.</span></div><div class=\"line\"><span class=\"comment\"># Fixed processing means that the frame rate is synced to the physics,</span></div><div class=\"line\"><span class=\"comment\"># i.e. the delta variable should be constant.</span></div><div class=\"line\"><span class=\"comment\"># only active when set_fixed_process(true) is called</span></div><div class=\"line\">func _fixed_process(delta):</div><div class=\"line\">\t<span class=\"comment\"># make a Vector2 variable movement and add gravity into y axis</span></div><div class=\"line\">\tvar movement = Vector2(<span class=\"number\">0</span>, velocity.y + GRAVITY * delta)</div><div class=\"line\">\t<span class=\"comment\">#input</span></div><div class=\"line\">\tvar right_input = Input.is_action_pressed(<span class=\"string\">\"right\"</span>)</div><div class=\"line\">\tvar left_input = Input.is_action_pressed(<span class=\"string\">\"left\"</span>)</div><div class=\"line\">\t<span class=\"comment\">#Apply the horizontal movement</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> right_input:</div><div class=\"line\">\t\tmovement.x = MOVE_SPEED</div><div class=\"line\">\t<span class=\"keyword\">elif</span> left_input:</div><div class=\"line\">\t\tmovement.x = -MOVE_SPEED</div><div class=\"line\">\t<span class=\"comment\"># set the velocity = movement</span></div><div class=\"line\">\tvelocity = movement</div><div class=\"line\">\t<span class=\"comment\"># set the maximum falling speed</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> velocity.y &gt; MAX_FALLING_SPEED:</div><div class=\"line\">\t\tvelocity.y = MAX_FALLING_SPEED</div><div class=\"line\">\t<span class=\"comment\"># apply the movement by calling move(velocity) and store the remaining movement</span></div><div class=\"line\">\tvar remaining_movement = move(velocity)</div><div class=\"line\">\t<span class=\"comment\"># collision handling</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> is_colliding():</div><div class=\"line\">\t\tvar normal = get_collision_normal()</div><div class=\"line\">\t\tremaining_movement = normal.slide(remaining_movement)</div><div class=\"line\">\t\tvelocity = normal.slide(velocity)</div><div class=\"line\">\t\tmove(remaining_movement)</div></pre></td></tr></table></figure>\n<p>Test it and see, the result must be like this</p>\n<img src=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/hor_move_fix.gif\" alt=\"Fixing Movement while Colliding\" title=\"Fixing Movement while Colliding\">\n<p>So for today, that was enough. If you still have extra energy, follow this link. All of you are AWESOME!</p>\n<p><a href=\"https://github.com/damarindra/2D-Platformer-Godot\" target=\"_blank\" rel=\"external\">Download Project Here</a></p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>","categories":["godot","tutorial","tutorial_platformer"],"tags":["Godot","gamedev","game","development","platformer"]},{"title":"Preparation - Platformer Tutorial Part 1 - Godot","url":"http://damarindra.com/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/","content":"<div class=\"spoiler collapsed\"><div class=\"spoiler-title\">Table of Content</div><div class=\"spoiler-content\"><!-- toc --></div></div>\n<p>Hello everyone, this is my first godot tutorial. I will explain how I can achieve platformer game in godot engine.<br><a id=\"more\"></a></p>\n<ol>\n<li><strong>Part 1 : Preparation</strong></li>\n<li><a href=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/\" title=\"Part 2 : Player Creation\">Part 2 : Player Creation</a></li>\n<li><a href=\"/2017/09/02/godot_platformer_tutorial/godot-1-2-player-creation-2/\" title=\"Part 3 : Player Creation 2\">Part 3 : Player Creation 2</a></li>\n<li><a href=\"/2017/09/07/godot_platformer_tutorial/godot-1-3-tilemap-and-camera/\" title=\"Part 4 : Tilemap and Camera\">Part 4 : Tilemap and Camera</a></li>\n<li><a href=\"/2017/09/12/godot_platformer_tutorial/godot-1-4-player-creation-3/\" title=\"Part 5 : Player Animation\">Part 5 : Player Animation</a></li>\n<li><a href=\"/2017/09/16/godot_platformer_tutorial/godot-1-5-parallax-and-level-bounds/\" title=\"Part 6 : Parallax Background and Level Bounds\">Part 6 : Parallax Background and Level Bounds</a>\n</li>\n</ol>\n<p>In this section only cover about preparation. I’m using :</p>\n<ul>\n<li><a href=\"https://downloads.tuxfamily.org/godotengine/2.1.3/\" target=\"_blank\" rel=\"external\">Godot Engine v2.1.3</a></li>\n<li><a href=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/tiles.png\" title=\"Asset Tiles\">Asset Tiles</a>\n</li>\n</ul>\n<p>For now, what you need is only 2 items. You can install Godot from Steam, or just follow this <a href=\"https://downloads.tuxfamily.org/godotengine/2.1.3/\" target=\"_blank\" rel=\"external\">link</a> and download the executable file depend on your OS. You can grab the asset tile from <a href=\"https://opengameart.org/content/arcade-platformer-assets\" target=\"_blank\" rel=\"external\">grafxkid in opengameart</a>, or just download directly <a href=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/tiles.png\" title=\"here\">here</a> (background color already alpha).</p>\n<h2 id=\"Create-Project\"><a href=\"#Create-Project\" class=\"headerlink\" title=\"Create Project\"></a>Create Project</h2><p>If you know how to create project skip this one, otherwise you can follow my step. Open Godot Engine, you will see Project Window, click New Project Button (on the right side), click browse to make easier, in my case is D:/Godot/V2/Platformer_Tutorial.</p>\n<img src=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/create_project.jpg\" alt=\"Create Project\" title=\"Create Project\">\n<p>If you were done, click Create button. Now open the project by double click from the project list.</p>\n<h2 id=\"Manage-the-Asset-Sprite\"><a href=\"#Manage-the-Asset-Sprite\" class=\"headerlink\" title=\"Manage the Asset Sprite\"></a>Manage the Asset Sprite</h2><p>You can copy directly from the file explorer into your project folder, then you can back into Godot Engine. Your file must be available in the FileSystem Window.</p>\n<img src=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/copy_asset.jpg\" alt=\"Copy Asset Tiles into Project\" title=\"Copy Asset Tiles into Project\">\n<p>Press F1 or click the 2D button in the top toolbar to show 2D view. Then on the Scene window create root node by clicking the ‘+’ button, select Node2D.</p>\n<img src=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/create_node2d.jpg\" alt=\"Create Node2D\" title=\"Create Node2D\">\n<p>After that, drag and drop the tiles.png into the scene view (middle one). As you can see, the image is blurry.</p>\n<img src=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/blurry.jpg\" alt=\"Blurry Image\" title=\"Blurry Image\">\n<p>You can fix it by changing the flags option. Double click the tiles.png from the FileSystem window. Now go into Inspector window and change the Flags by disabling everything.</p>\n<img src=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/flags.jpg\" alt=\"Image Flags\" title=\"Image Flags\">\n<p>If the image on the scene still blurry, you can try by reloading the image. Still in the Inspector window, Click on the Image option - Load - select tiles.png. Now the image must be fixed.</p>\n<img src=\"/2017/08/24/godot_platformer_tutorial/godot-1-0-preparation/reload.gif\" alt=\"Reload Image\" title=\"Reload Image\">\n<p>Okay, the preparation is done, you can go to the <a href=\"/2017/08/28/godot_platformer_tutorial/godot-1-1-player-creation/\" title=\"next post\">next post</a> . Have Fun!!</p>\n<p><a href=\"https://github.com/damarindra/2D-Platformer-Godot\" target=\"_blank\" rel=\"external\">Download Project Here</a></p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>","categories":["godot","tutorial","tutorial_platformer"],"tags":["Godot","gamedev","game","development","platformer"]},{"title":"Why Godot?","url":"http://damarindra.com/2017/08/23/godot_why_i_choose_godot/","content":"<div class=\"spoiler collapsed\"><div class=\"spoiler-title\">Table of Content</div><div class=\"spoiler-content\"><!-- toc --></div></div>\n<h2 id=\"How-I-met-with-Godot\"><a href=\"#How-I-met-with-Godot\" class=\"headerlink\" title=\"How I met with Godot?\"></a>How I met with Godot?</h2><p>I do not really remember when it is, maybe January 2015 that was my first time I’ve found Godot. At that time, I’ve been joined open source community named Doscom (Dinus Open Source Community) and Doscom held a workshop about game development. So I’m the one who focussed on game development has a job to teaching.<br><a id=\"more\"></a> Because the community is open source, I need to find the open source game engine, and finally, I found out Godot. Why I chose Godot? I’m used to developing a game with Unity3D, and Godot is the similar one. Okay I will not explain more about the past, anyway you can check it <a href=\"https://doscom.org/blog/workshop-pembuatan-game-space-radian-dengan-godot-engine/\" target=\"_blank\" rel=\"external\">here</a> about the event.</p>\n<h2 id=\"Why-I’m-back-using-Godot\"><a href=\"#Why-I’m-back-using-Godot\" class=\"headerlink\" title=\"Why I’m back using Godot?\"></a>Why I’m back using Godot?</h2><p>Mid 2017, I’ve decided to use Godot again, why? Without open source (Doscom), I don’t know about Game Dev. So I want to give a feedback, the only way is using godot and share what I’ve learned. I will post blogs here, and maybe videos on youtube.</p>\n<h2 id=\"What-do-you-think-about-Unity-vs-Godot\"><a href=\"#What-do-you-think-about-Unity-vs-Godot\" class=\"headerlink\" title=\"What do you think about Unity vs Godot?\"></a>What do you think about Unity vs Godot?</h2><p>Okay, mostly I’ve been developing 2D games. After I try to using Godot again, I’ve been really surprised, Godot really easy when developing 2D games, for example, the KinematicBody2D has a move function. Move function calculates and detects a collision. As far as I know, Unity doesn’t has this function, only the CharacterController on 3D has the move function. Godot also has a tilemap node, which Unity doesn’t (planned September 2017 ??). So for me, this is really helpful!! TFW, KinematicBody can get the floor (collider) velocity!! Godot, you stole my heart!!</p>\n<p>If you want to know godot more, you can search it in google, there is so many article about godot. I will recommend this one <a href=\"http://www.gamefromscratch.com/post/2015/01/04/A-Closer-Look-at-the-Godot-Game-Engine.aspx\" target=\"_blank\" rel=\"external\">GameFromScratch</a></p>\n<h1 id=\"SUPPORT-GODOT\"><a href=\"#SUPPORT-GODOT\" class=\"headerlink\" title=\"SUPPORT GODOT\"></a>SUPPORT GODOT</h1><p>Don’t forget to support godot to make it good and more good!! If you can donate, you can support it via <a href=\"https://www.patreon.com/godotengine/posts\" target=\"_blank\" rel=\"external\">Patreon</a>, or just one time donation via <a href=\"https://godotengine.org/donate\" target=\"_blank\" rel=\"external\">Paypal</a>. Don’t worry if you can’t donate, you can support godot by using Godot for now, spread the words!!!</p>\n<p>.</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>","categories":["godot"],"tags":["Godot","gamedev","game","development"]},{"title":"all-categories","url":"http://damarindra.com/all-categories/index.html","content":"<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>","categories":[],"tags":[]},{"title":"all-tags","url":"http://damarindra.com/all-tags/index.html","content":"<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>","categories":[],"tags":[]},{"title":"all-archives","url":"http://damarindra.com/all-archives/index.html","content":"<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>","categories":[],"tags":[]}]